
<!DOCTYPE html>
<html lang="en" class="scroll-smooth">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Raiyan Hasan - Web Developer Portfolio </title>
    <meta name="description"
        content="Welcome to the enhanced portfolio of Raiyan Hasan (v3.6 - Dynamic), an IT student at MIT Muzaffarpur. Features dynamically rendered projects, enhanced filters, UI improvements, interactive elements (Typed.js), micro-interactions, animations, CV download, accessible modals, and a functional contact form UI.">
    <meta name="keywords"
        content="Raiyan Hasan, web developer, portfolio, MIT Muzaffarpur, MERN Stack, React, Node.js, JavaScript, Tailwind CSS, front-end developer, student developer, dark mode, accessible portfolio, interactive portfolio, Typed.js, portfolio filters, dynamic portfolio, resume download, contact form UI, ui improvements, microinteractions, javascript portfolio">
    <meta name="author" content="Raiyan Hasan">
    <link rel="canonical" href="https://hasanraiyan.github.io/Portfolio/"> <!-- UPDATE if you host elsewhere -->

    <!-- Open Graph / Facebook -->
    <meta property="og:title" content="Raiyan Hasan - Dynamic Web Developer Portfolio v3.6">
    <meta property="og:description"
        content="Explore the dynamic web development portfolio of Raiyan Hasan (v3.6), student at MIT Muzaffarpur. Featuring dynamically rendered projects, Typed.js intro, improved project filters, UI improvements, micro-interactions, preloader, CV download, accessible modals, and contact form UI.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://hasanraiyan.github.io/Portfolio/"> <!-- UPDATE if you host elsewhere -->
    <meta property="og:image" content="https://hasanraiyan.github.io/Portfolio/images/user1.png"> <!-- Ensure path -->
    <meta property="og:image:alt" content="Raiyan Hasan Profile Picture">

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Raiyan Hasan - Dynamic Web Developer Portfolio v3.6">
    <meta name="twitter:description"
        content="Explore the dynamic web development portfolio of Raiyan Hasan (v3.6), student at MIT Muzaffarpur. Featuring dynamically rendered projects, Typed.js intro, improved project filters, UI improvements, micro-interactions, preloader, CV download, accessible modals, and contact form UI.">
    <meta name="twitter:image" content="https://hasanraiyan.github.io/Portfolio/images/user1.png"> <!-- Ensure path -->
    <meta name="twitter:image:alt" content="Raiyan Hasan Profile Picture">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">

    <!-- Font Awesome -->
    <script src="https://kit.fontawesome.com/002a13abdf.js" crossorigin="anonymous"></script>

    <!-- Tailwind CSS CDN (for development) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- PRODUCTION NOTE: The Tailwind CDN is for development only. For production, install Tailwind: https://tailwindcss.com/docs/installation -->

    <!-- Typed.js CDN -->
    <script src="https://unpkg.com/typed.js@2.1.0/dist/typed.umd.js"></script>

    <!-- Vanilla-Tilt.js CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vanilla-tilt/1.7.0/vanilla-tilt.min.js"></script>

    <!-- Tailwind Configuration -->
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        'poppins': ['Poppins', 'sans-serif']
                    },
                    colors: {
                        primary: '#0a66c2', // LinkedIn Blue
                        'primary-darker': '#004182',
                        secondary: '#28a745', // Green
                        accent: '#ffc107', // Yellow
                        'text-main': '#1f2937', // gray-800
                        'text-light': '#4b5563', // gray-600
                        'bg-light': '#f8fafc', // slate-50
                        'bg-surface': '#ffffff', // white
                        'border-light': '#e5e7eb', // gray-200
                        'glass-bg': 'rgba(255, 255, 255, 0.6)',
                        'glass-border': 'rgba(255, 255, 255, 0.3)',
                        'dark-bg-input': '#374151', // gray-700
                        'dark-bg-surface-card': '#1f2937', // gray-800 (match surface)
                        dark: {
                            primary: '#38bdf8', // sky-400
                            'primary-darker': '#0ea5e9', // sky-500
                            secondary: '#4ade80', // green-400
                            accent: '#facc15', // yellow-400
                            'text-main': '#e5e7eb', // gray-200
                            'text-light': '#9ca3af', // gray-400
                            'bg-dark': '#111827', // gray-900
                            'bg-surface': '#1f2937', // gray-800
                            'border-dark': '#374151', // gray-700
                            'glass-bg': 'rgba(31, 41, 55, 0.65)', // gray-800 with alpha
                            'glass-border': 'rgba(55, 65, 81, 0.3)', // gray-700 with alpha
                        }
                    },
                    animation: {
                        'fade-in': 'fadeIn 0.5s ease-out forwards',
                        'fade-in-up': 'fadeInUp 0.6s ease-out forwards',
                        'slide-in-left': 'slideInLeft 0.6s ease-out forwards',
                        'slide-in-right': 'slideInRight 0.6s ease-out forwards',
                        'pulse-glow': 'pulseGlow 2.5s infinite ease-in-out',
                        'spin': 'spin 1s linear infinite', // For preloader
                        'gradient-shift': 'gradientShift 15s ease infinite', // For hero background
                        'show-more-item': 'showMoreItem 0.5s ease-out forwards', // For show more items
                    },
                    keyframes: {
                        fadeIn: { '0%': { opacity: '0' }, '100%': { opacity: '1' }, },
                        fadeInUp: { '0%': { opacity: '0', transform: 'translateY(20px)' }, '100%': { opacity: '1', transform: 'translateY(0)' }, },
                        slideInLeft: { '0%': { opacity: '0', transform: 'translateX(-30px)' }, '100%': { opacity: '1', transform: 'translateX(0)' }, },
                        slideInRight: { '0%': { opacity: '0', transform: 'translateX(30px)' }, '100%': { opacity: '1', transform: 'translateX(0)' }, },
                        pulseGlow: {
                            '0%, 100%': { boxShadow: '0 0 8px rgba(10, 102, 194, 0.2)', },
                            '50%': { boxShadow: '0 0 25px rgba(10, 102, 194, 0.6)', },
                        },
                        spin: { 'from': { transform: 'rotate(0deg)' }, 'to': { transform: 'rotate(360deg)' }, },
                        gradientShift: { // Subtle gradient animation for hero
                            '0%, 100%': { backgroundPosition: '0% 50%' },
                            '50%': { backgroundPosition: '100% 50%' },
                        },
                        showMoreItem: { // Animation for items revealed by "Show More"
                            '0%': { opacity: '0', transform: 'translateY(10px)' },
                            '100%': { opacity: '1', transform: 'translateY(0)' },
                        },
                    },
                    backdropBlur: { xs: '2px', sm: '4px', md: '8px', lg: '12px', xl: '16px', },
                    boxShadow: {
                        'glass-dark': 'inset 0 1px 1px rgba(255, 255, 255, 0.05), 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1)',
                    }
                },
            },
            plugins: [],
        }
    </script>

    <!-- Custom Styles (Tailwind Layers) -->
    <style type="text/tailwindcss">
        @layer base {
            html {
                @apply font-poppins antialiased bg-bg-light text-text-main dark:bg-dark-bg-dark dark:text-dark-text-main transition-colors duration-300 ease-in-out;
            }
            body {
                 @apply transition-colors duration-300 ease-in-out;
            }

            /* Reduced Motion Preferences */
            @media (prefers-reduced-motion: reduce) {
                html { scroll-behavior: auto; }
                *, *::before, *::after {
                    animation-duration: 1ms !important;
                    animation-iteration-count: 1 !important;
                    transition-duration: 1ms !important;
                    transition-delay: 0ms !important;
                    scroll-behavior: auto !important;
                }
                .animate-bounce { animation: none; }
                .animate-pulse-glow { animation: none; }
                .animate-spin { animation: none; }
                .animate-gradient-shift { animation: none; } /* Disable background shift */
                .animate-show-more-item { animation: none; } /* Disable show more animation */
                /* Remove transforms from interactive elements */
                .group:hover .group-hover\:scale-\[1\.02\],
                .hover\:scale-105, .focus-visible\:scale-105,
                .hover\:scale-110, .focus-visible\:scale-110,
                .group:hover .group-hover\:translate-x-1,
                .hover\:-translate-y-0\.5 { /* Added nav link hover */
                     transform: none !important;
                }
                /* Disable tilt effect */
                .work-item[data-tilt] { transform-style: flat !important; }
                .js-tilt-glare { display: none !important; }
            }

            /* Scroll Animations */
            .animate-on-scroll { @apply opacity-0; }
            .animate-on-scroll { @apply transition-all duration-700 ease-out; }
            .animate-on-scroll.is-visible { @apply opacity-100; }
            .animate-fade-up.is-visible { @apply translate-y-0; }
            .animate-fade-up { @apply translate-y-5; }
            .animate-slide-left.is-visible { @apply translate-x-0; }
            .animate-slide-left { @apply translate-x-[-30px]; }
            .animate-slide-right.is-visible { @apply translate-x-0; }
            .animate-slide-right { @apply translate-x-[30px]; }

            /* Nav Link Underline & Hover Lift */
            #main-nav ul:not(#sidemenu) li a {
                @apply relative py-2 transition-all duration-300 hover:-translate-y-0.5; /* Added hover lift */
            }
            #main-nav ul:not(#sidemenu) li a::after {
                 content: '';
                 @apply absolute bottom-[-5px] left-0 h-[3px] w-0 bg-gradient-to-r from-primary to-accent dark:from-dark-primary dark:to-dark-accent rounded-full transition-all duration-500;
             }
             #main-nav ul:not(#sidemenu) li a:hover::after,
             #main-nav ul:not(#sidemenu) li a.active-nav::after {
                 @apply w-full;
             }

             /* Focus Styles */
             *:focus-visible {
                @apply outline-none ring-2 ring-offset-2 ring-primary/70 dark:ring-dark-primary/70 ring-offset-bg-surface dark:ring-offset-dark-bg-surface rounded-sm transition duration-150; /* Slightly softer ring */
             }
             *:focus:not(:focus-visible) { outline: none; } /* Hide focus ring for mouse users */

             /* Skip Link */
             .skip-link {
                 @apply sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 focus:z-[100] focus:bg-primary focus:text-white focus:px-4 focus:py-2 focus:rounded-md focus:font-semibold focus:shadow-lg;
             }

            /* Form Invalid Styles (using Tailwind's invalid: modifier) */
             input:invalid:not(:placeholder-shown),
             textarea:invalid:not(:placeholder-shown) {
                 /* Uses tailwind invalid: classes directly in HTML, e.g., invalid:border-pink-500 */
             }
             input:required, textarea:required {
                 /* Uses tailwind required: classes if needed, but invalid: usually covers it */
             }
             input:focus:invalid, textarea:focus:invalid {
                 /* Uses tailwind invalid:focus: classes, e.g., invalid:focus:ring-pink-500/50 */
             }

            /* Typed.js Cursor Styling */
            .typed-cursor {
                @apply opacity-100 animate-pulse text-primary dark:text-dark-primary font-light;
            }
        }
        @layer components {
            .glass-effect {
                @apply bg-glass-bg dark:bg-dark-glass-bg backdrop-blur-md border border-glass-border dark:border-dark-border-dark shadow-lg dark:shadow-glass-dark;
            }
            /* Enhanced Button Base */
            .btn {
                @apply inline-block px-6 py-2.5 rounded-full font-medium text-center transition-all duration-300 ease-in-out shadow-md hover:shadow-lg focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none transform hover:scale-105 focus-visible:scale-105; /* Added transform */
            }
            .btn-primary {
                @apply bg-gradient-to-r from-primary to-blue-500 text-white border border-transparent hover:from-primary-darker hover:to-primary focus-visible:ring-primary dark:from-dark-primary dark:to-blue-600 dark:hover:from-dark-primary-darker dark:hover:to-dark-primary dark:focus-visible:ring-dark-primary;
            }
            .btn-secondary {
                 @apply bg-transparent text-primary border border-primary hover:bg-primary/10 focus-visible:ring-primary dark:text-dark-primary dark:border-dark-primary dark:hover:bg-dark-primary/10 dark:focus-visible:ring-dark-primary;
            }
            /* Standard Content Card */
            .content-card {
                @apply bg-bg-surface dark:bg-dark-bg-surface rounded-xl shadow-lg dark:shadow-dark-bg-dark/30 overflow-hidden transition-all duration-300 hover:shadow-2xl dark:hover:shadow-dark-bg-dark/50 hover:-translate-y-1.5 p-6 md:p-8;
            }
            /* Tab Styling */
            .tab-links.active-link {
                @apply text-primary dark:text-dark-primary border-primary dark:border-dark-primary font-semibold;
            }
            .tab-links {
                @apply border-b-2 pb-1 border-transparent dark:border-transparent text-text-light dark:text-dark-text-light hover:text-primary dark:hover:text-dark-primary transition-colors duration-200;
            }
            /* Tab Content Transition */
             .tab-contents {
                 @apply transition-opacity duration-300 ease-in-out; /* Base transition for tabs */
             }
             .tab-contents.hidden {
                  @apply !opacity-0 pointer-events-none absolute; /* Use opacity + absolute for smooth transition */
             }
             .tab-contents.active-tab {
                 @apply opacity-100 pointer-events-auto relative; /* Ensure active is relative */
             }
             /* Subtitle Underlines */
             .subtitle-underline::after {
                 content: '';
                 @apply absolute bottom-0 left-1/2 -translate-x-1/2 w-16 h-1 bg-gradient-to-r from-primary to-accent dark:from-dark-primary dark:to-dark-accent rounded-full;
             }
             .subtitle-underline-left::after {
                 content: '';
                 @apply absolute bottom-0 left-0 w-16 h-1 bg-gradient-to-r from-primary to-accent dark:from-dark-primary dark:to-dark-accent rounded-full;
             }
            /* Enhanced Modal Styling */
            .modal-overlay {
                @apply fixed inset-0 bg-black/60 dark:bg-black/80 flex items-center justify-center p-4 z-[60] transition-opacity duration-300 ease-out opacity-0 pointer-events-none; /* Use ease-out for fade */
            }
            .modal-overlay.active {
                @apply opacity-100 pointer-events-auto;
            }
            .modal-content {
                @apply bg-bg-surface dark:bg-dark-bg-surface rounded-lg shadow-xl p-6 md:p-8 max-w-xl w-full max-h-[85vh] overflow-y-auto relative transform scale-95 opacity-0 transition-all duration-300 ease-out; /* Added opacity, use ease-out */
            }
             .modal-overlay.active .modal-content {
                 @apply scale-100 opacity-100; /* Animate scale and opacity together */
             }

             /* Preloader Styles */
            #preloader {
                 @apply fixed inset-0 z-[9999] flex items-center justify-center bg-bg-light dark:bg-dark-bg-dark transition-opacity duration-500 ease-out;
            }
            #preloader.loaded {
                @apply opacity-0 pointer-events-none;
            }
            .spinner {
                @apply w-12 h-12 border-4 border-primary dark:border-dark-primary border-t-transparent rounded-full animate-spin;
            }

            /* Styling for dynamically added 'show more' items */
            .show-more-item {
                 @apply opacity-0 /* Start hidden for animation */;
            }
             /* Style for items hidden by show/less, separate from filter hiding */
            .work-item.show-more-item-hidden {
                 @apply !opacity-0 !pointer-events-none !h-0 !p-0 !m-0 !border-0 overflow-hidden; /* More robust hiding for layout */
                 transition: opacity 0.3s ease-out, transform 0.3s ease-out; /* Add transition for reveal */
            }
            .show-more-item.animate-in {
                 @apply animate-show-more-item;
            }

            /* Portfolio Layer */
            .work-item .layer {
                 @apply absolute inset-0 bg-gradient-to-t from-blue-800/80 via-blue-700/70 to-transparent dark:from-blue-900/80 dark:via-blue-800/70 opacity-0 group-hover:opacity-100 transition-all duration-500 flex flex-col items-center justify-end p-4 sm:p-6 text-center transform translate-y-4 group-hover:translate-y-0;
            }
             /* Portfolio Filter Button */
             .filter-btn.active { /* Base active styles */
                 @apply bg-primary/10 dark:bg-dark-primary/10 text-primary dark:text-dark-primary font-semibold;
             }
             /* Portfolio Item transition for filtering */
             .work-item {
                 @apply transition-opacity duration-300 ease-out transform transition-transform duration-300 ease-out;
             }
             .work-item.hidden { /* Style for items hidden by FILTERING */
                 @apply !opacity-0 !scale-95 !pointer-events-none;
                 /* Use !important carefully if needed, but utility classes below should handle it */
             }
        }
        @layer utilities {
            /* Ensure hidden utility takes precedence for filter hiding */
            .hidden { display: none !important; }

            /* Portfolio hover icon animation */
            .work-item .layer a:hover i, .work-item .layer button:hover i { @apply rotate-[360deg] transition-transform duration-500; }

            /* Visually hidden but screen-reader accessible */
            .sr-only {
                position: absolute;
                width: 1px;
                height: 1px;
                padding: 0;
                margin: -1px;
                overflow: hidden;
                clip: rect(0, 0, 0, 0);
                white-space: nowrap;
                border-width: 0;
            }
            .focus\:not-sr-only:focus {
                position: static;
                width: auto;
                height: auto;
                padding: 0;
                margin: 0;
                overflow: visible;
                clip: auto;
                white-space: normal;
            }
            /* Add consistent hover/focus scale to icons */
           .icon-interact {
               @apply transition-all duration-300 ease-in-out transform hover:scale-110 focus-visible:scale-110;
           }
        }

        /* Fallback for browsers not supporting backdrop-filter */
        @supports not ((-webkit-backdrop-filter: none) or (backdrop-filter: none)) {
            .glass-effect { @apply bg-white/95 dark:bg-dark-bg-surface/95; } /* Slightly less transparent fallback */
        }
    </style>

    <!-- Theme Initialization Script (Before Body) -->
    <script>
        if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            document.documentElement.classList.add('dark')
        } else {
            document.documentElement.classList.remove('dark')
        }
    </script>
</head>

<body class="bg-bg-light text-text-main dark:bg-dark-bg-dark dark:text-dark-text-main">

    <!-- Preloader -->
    <div id="preloader">
        <div class="spinner"></div>
    </div>

    <!-- Skip Link -->
    <a href="#main-content" class="skip-link">Skip to main content</a>

    <!-- Header -->
    <header id="site-header" class="sticky top-0 z-50 transition-all duration-300 ease-in-out">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8">
            <nav id="main-nav" class="flex items-center justify-between h-16 md:h-20">
                <a href="#hero"
                    class="logo-link flex-shrink-0 transition-transform duration-300 hover:scale-105 animate-on-scroll animate-slide-left icon-interact"
                    data-animate>
                    <img src="./images/logo.png" alt="Raiyan Hasan Logo" class="h-10 md:h-12"> <!-- Check path -->
                </a>
                <!-- Desktop Navigation -->
                <div class="hidden md:flex items-center space-x-6 lg:space-x-8 animate-on-scroll animate-fade-up"
                    data-animate>
                    <ul class="flex items-center space-x-6 lg:space-x-8">
                        <li><a href="#hero"
                                class="nav-link text-text-main dark:text-dark-text-light hover:text-primary dark:hover:text-dark-primary font-medium">Home</a>
                        </li>
                        <li><a href="#about"
                                class="nav-link text-text-main dark:text-dark-text-light hover:text-primary dark:hover:text-dark-primary font-medium">About</a>
                        </li>
                        <li><a href="#portfolio"
                                class="nav-link text-text-main dark:text-dark-text-light hover:text-primary dark:hover:text-dark-primary font-medium">Portfolio</a>
                        </li>
                        <li><a href="#contact"
                                class="nav-link text-text-main dark:text-dark-text-light hover:text-primary dark:hover:text-dark-primary font-medium">Contact</a>
                        </li>
                    </ul>
                    <button id="theme-toggle" type="button"
                        class="text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 focus-visible:ring-2 focus-visible:ring-gray-400 dark:focus-visible:ring-gray-500 rounded-lg text-sm p-2.5 transition-colors duration-200 icon-interact"
                        aria-label="Toggle dark mode" aria-pressed="false">
                        <svg id="theme-toggle-dark-icon" class="hidden w-5 h-5" fill="currentColor" viewBox="0 0 20 20"
                            xmlns="http://www.w3.org/2000/svg">
                            <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path>
                        </svg>
                        <svg id="theme-toggle-light-icon" class="hidden w-5 h-5" fill="currentColor" viewBox="0 0 20 20"
                            xmlns="http://www.w3.org/2000/svg">
                            <path
                                d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z"
                                fill-rule="evenodd" clip-rule="evenodd"></path>
                        </svg>
                    </button>
                </div>
                <!-- Mobile Menu Toggles -->
                <div class="md:hidden flex items-center space-x-4">
                    <button id="theme-toggle-mobile" type="button"
                        class="text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 focus-visible:ring-2 focus-visible:ring-gray-400 dark:focus-visible:ring-gray-500 rounded-lg text-sm p-2.5 transition-colors duration-200 icon-interact"
                        aria-label="Toggle dark mode" aria-pressed="false">
                        <svg id="theme-toggle-dark-icon-mobile" class="hidden w-5 h-5" fill="currentColor"
                            viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                            <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path>
                        </svg>
                        <svg id="theme-toggle-light-icon-mobile" class="hidden w-5 h-5" fill="currentColor"
                            viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                            <path
                                d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z"
                                fill-rule="evenodd" clip-rule="evenodd"></path>
                        </svg>
                    </button>
                    <button
                        class="icon-menu text-primary dark:text-dark-primary text-3xl hover:text-primary-darker dark:hover:text-dark-primary-darker transition-colors duration-300 icon-interact"
                        onclick="openmenu()" aria-label="Open menu" aria-expanded="false" aria-controls="sidemenu">
                        <i class="fas fa-bars" aria-hidden="true"></i>
                    </button>
                </div>
                <!-- Side Menu (Mobile) -->
                <ul id="sidemenu"
                    class="md:hidden fixed top-0 right-0 h-screen w-64 sm:w-72 bg-gradient-to-b from-primary-darker to-primary dark:from-dark-primary-darker dark:to-dark-primary shadow-xl transform translate-x-full transition-transform duration-300 ease-in-out pt-24 px-6 space-y-5 z-40"
                    aria-hidden="true">
                    <li><a href="#hero"
                            class="block text-white hover:text-accent dark:hover:text-dark-accent text-xl font-medium py-2 transition-colors duration-300">Home</a>
                    </li>
                    <li><a href="#about"
                            class="block text-white hover:text-accent dark:hover:text-dark-accent text-xl font-medium py-2 transition-colors duration-300">About</a>
                    </li>
                    <li><a href="#portfolio"
                            class="block text-white hover:text-accent dark:hover:text-dark-accent text-xl font-medium py-2 transition-colors duration-300">Portfolio</a>
                    </li>
                    <li><a href="#contact"
                            class="block text-white hover:text-accent dark:hover:text-dark-accent text-xl font-medium py-2 transition-colors duration-300">Contact</a>
                    </li>
                    <li class="absolute top-6 right-6">
                        <button
                            class="icon-close text-white hover:text-gray-200 text-3xl transition-colors duration-300 icon-interact"
                            onclick="closemenu()" aria-label="Close menu">
                            <i class="fas fa-times" aria-hidden="true"></i>
                        </button>
                    </li>
                </ul>
            </nav>
        </div>
    </header>

    <!-- Main Content Wrapper -->
    <main id="main-content">

        <!-- Hero Section -->
        <section id="hero" class="pt-28 md:pt-32 pb-20 md:pb-28 min-h-[calc(100vh-80px)] flex items-center relative overflow-hidden
                       bg-gradient-to-br from-blue-100 via-bg-light to-indigo-100
                       dark:from-gray-900 dark:via-dark-bg-dark dark:to-indigo-900/40
                       bg-[length:200%_200%] animate-gradient-shift">
            <!-- Decorative Blobs -->
            <div
                class="absolute top-1/4 left-10 w-32 h-32 bg-blue-200/30 dark:bg-blue-800/20 rounded-full filter blur-2xl opacity-50 dark:opacity-30 animate-pulse-glow">
            </div>
            <div
                class="absolute bottom-1/4 right-10 w-40 h-40 bg-indigo-200/30 dark:bg-indigo-800/20 rounded-full filter blur-2xl opacity-50 dark:opacity-30 animate-pulse-glow animation-delay-2000">
            </div>

            <div class="container mx-auto px-4 sm:px-6 lg:px-8 z-10">
                <div class="header-text text-center max-w-4xl mx-auto">
                    <p class="text-lg md:text-xl text-primary dark:text-dark-primary font-medium mb-3 animate-on-scroll animate-fade-up"
                        data-animate data-delay="100">MERN Stack Web Developer & IT Student</p>
                    <h1 class="text-4xl sm:text-5xl lg:text-6xl xl:text-7xl font-bold text-text-main dark:text-dark-text-main leading-tight mb-6 animate-on-scroll animate-fade-up"
                        data-animate data-delay="200">
                        Hi, I'm <span
                            class="text-transparent bg-clip-text bg-gradient-to-r from-primary to-blue-500 dark:from-dark-primary dark:to-blue-400">Raiyan
                            Hasan</span><br>
                        <span id="typed-output" class="text-primary dark:text-dark-primary"></span> <!-- Typed.js Target -->
                    </h1>
                    <p class="text-base md:text-lg text-text-light dark:text-dark-text-light max-w-2xl mx-auto mb-8 animate-on-scroll animate-fade-up"
                        data-animate data-delay="300">
                        Passionate about crafting clean, efficient, and user-friendly web experiences using the MERN
                        stack. Exploring the intersection of technology, creativity, and problem-solving. Always eager
                        to learn and adapt.
                    </p>
                    <div class="animate-on-scroll animate-fade-up" data-animate data-delay="400">
                        <a href="#portfolio" class="btn btn-primary text-lg px-8 py-3 mr-3 mb-3 sm:mb-0">View My
                            Work</a>
                        <a href="#contact" class="btn btn-secondary text-lg px-8 py-3">Get In Touch</a>
                    </div>
                </div>
            </div>
            <a href="#about"
                class="absolute bottom-8 left-1/2 -translate-x-1/2 text-primary dark:text-dark-primary text-2xl animate-bounce hidden md:block icon-interact"
                aria-label="Scroll down">
                <i class="fas fa-chevron-down"></i>
            </a>
        </section>

        <!-- About Section -->
        <section id="about" class="py-20 md:py-28 bg-bg-surface dark:bg-dark-bg-surface">
            <div class="container mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex flex-wrap lg:flex-nowrap justify-between gap-12 md:gap-16 items-start">
                    <div class="about-col-1 w-full lg:w-2/5 xl:w-1/3 flex-shrink-0 animate-on-scroll animate-slide-left"
                        data-animate>
                        <div class="relative group">
                            <div
                                class="absolute -inset-1 bg-gradient-to-r from-primary to-accent dark:from-dark-primary dark:to-dark-accent rounded-lg blur opacity-25 group-hover:opacity-50 transition duration-500">
                            </div>
                            <img src="./images/user1.png" alt="Raiyan Hasan profile picture"
                                class="relative rounded-xl shadow-xl w-full max-w-sm mx-auto lg:max-w-none transition-transform duration-300 group-hover:scale-[1.02]"
                                loading="lazy"> <!-- Check path -->
                        </div>
                    </div>
                    <div class="about-col-2 w-full lg:w-3/5 xl:w-2/3 animate-on-scroll animate-slide-right"
                        data-animate>
                        <h2
                            class="subtitle text-3xl md:text-4xl text-primary dark:text-dark-primary font-semibold mb-14 md:mb-16 text-left relative pb-4 subtitle-underline-left">
                            About Me
                        </h2>
                        <p
                            class="about-intro text-base md:text-lg text-text-light dark:text-dark-text-light mb-6 leading-relaxed md:leading-loose">
                            Hello! I'm Raiyan Hasan, a dedicated B.Tech student in Information Technology at MIT
                            Muzaffarpur (Batch 2023-27). My fascination lies at the intersection of technology and
                            creativity, particularly in web development where I strive to build intuitive, efficient,
                            and accessible digital experiences.
                        </p>

                        <div class="tab-titles flex border-b border-border-light dark:border-dark-border-dark mb-6 space-x-4 sm:space-x-8 flex-wrap"
                            role="tablist" aria-label="About Me Sections">
                            <button
                                class="tab-links active-link py-2 px-1 sm:px-2 font-medium transition-all duration-300 whitespace-nowrap"
                                onclick="opentab(event, 'skills-panel')" role="tab" aria-controls="skills-panel"
                                aria-selected="true" id="skills-tab" tabindex="0">Skills</button>
                            <button
                                class="tab-links py-2 px-1 sm:px-2 font-medium transition-all duration-300 whitespace-nowrap"
                                onclick="opentab(event, 'education-panel')" role="tab" aria-controls="education-panel"
                                aria-selected="false" id="education-tab" tabindex="-1">Education</button>
                        </div>

                        <!-- Skills Tab Panel -->
                        <div class="tab-contents active-tab min-h-[250px] relative" id="skills-panel" role="tabpanel"
                            aria-labelledby="skills-tab" aria-hidden="false">
                            <ul class="space-y-5">
                                <li>
                                    <div
                                        class="tab-item-content pl-5 border-l-4 border-primary dark:border-dark-primary py-2 group">
                                        <a href="https://www.hackerrank.com/certificates/bb25b2ccfbf1"
                                            title="Click to see certification" target="_blank" rel="noopener noreferrer"
                                            class="inline-block transition-colors duration-300 group-hover:text-primary-darker dark:group-hover:text-dark-primary-darker">
                                            <strong
                                                class="block text-lg font-semibold text-text-main dark:text-dark-text-main mb-1 flex items-center">
                                                <i
                                                    class="fab fa-python mr-2 text-lg text-primary dark:text-dark-primary"></i>
                                                Python <i
                                                    class="fas fa-link text-xs ml-2 opacity-0 group-hover:opacity-70 transition-opacity"
                                                    aria-hidden="true"></i>
                                            </strong>
                                        </a>
                                        <span class="block text-sm text-text-light dark:text-dark-text-light ml-7">
                                            Proficient in Python for problem-solving and scripting (HackerRank
                                            Certified).
                                        </span>
                                    </div>
                                </li>
                                <li>
                                    <div
                                        class="tab-item-content pl-5 border-l-4 border-primary dark:border-dark-primary py-2">
                                        <strong
                                            class="block text-lg font-semibold text-text-main dark:text-dark-text-main mb-1 flex items-center">
                                            <i class="fas fa-code mr-2 text-lg text-primary dark:text-dark-primary"></i>
                                            MERN Stack Development
                                        </strong>
                                        <span class="block text-sm text-text-light dark:text-dark-text-light ml-7">
                                            Experience with MongoDB, Express.js, React, Node.js, plus HTML, CSS (incl.
                                            Tailwind), and JavaScript for full-stack applications.
                                        </span>
                                    </div>
                                </li>
                            </ul>
                            <ul id="skills-list-hidden" class="space-y-5 mt-5">
                                <li class="hidden show-more-item">
                                    <div
                                        class="tab-item-content pl-5 border-l-4 border-secondary dark:border-dark-secondary py-2">
                                        <strong
                                            class="block text-lg font-semibold text-text-main dark:text-dark-text-main mb-1 flex items-center">
                                            <i
                                                class="fas fa-palette mr-2 text-lg text-secondary dark:text-dark-secondary"></i>
                                            Canva
                                        </strong>
                                        <span class="block text-sm text-text-light dark:text-dark-text-light ml-7">
                                            Skilled in creating visual assets and graphics using Canva.
                                        </span>
                                    </div>
                                </li>
                                <li class="hidden show-more-item">
                                    <div
                                        class="tab-item-content pl-5 border-l-4 border-secondary dark:border-dark-secondary py-2">
                                        <strong
                                            class="block text-lg font-semibold text-text-main dark:text-dark-text-main mb-1 flex items-center">
                                            <i
                                                class="fab fa-react mr-2 text-lg text-secondary dark:text-dark-secondary"></i>
                                            React Native
                                        </strong>
                                        <span class="block text-sm text-text-light dark:text-dark-text-light ml-7">
                                            Building cross-platform mobile applications.
                                        </span>
                                    </div>
                                </li>
                                <li class="hidden show-more-item">
                                    <div
                                        class="tab-item-content pl-5 border-l-4 border-accent dark:border-dark-accent py-2">
                                        <strong
                                            class="block text-lg font-semibold text-text-main dark:text-dark-text-main mb-1 flex items-center">
                                            <i
                                                class="fab fa-git-alt mr-2 text-lg text-accent dark:text-dark-accent"></i>
                                            Version Control
                                        </strong>
                                        <span class="block text-sm text-text-light dark:text-dark-text-light ml-7">
                                            Using Git and GitHub for code management and collaboration.
                                        </span>
                                    </div>
                                </li>
                            </ul>

                            <div class="mt-8 pt-5 border-t border-border-light dark:border-dark-border-dark">
                                <strong
                                    class="block text-lg font-semibold text-text-main dark:text-dark-text-main mb-3">Currently
                                    Learning</strong>
                                <ul
                                    class="list-disc list-inside space-y-1 text-sm text-text-light dark:text-dark-text-light pl-1">
                                    <li>Advanced MERN stack concepts & optimization</li>
                                    <li>Deeper dive into responsive design patterns</li>
                                    <li>Web Accessibility (WCAG) best practices</li>
                                    <li>Further exploring React Native</li>
                                </ul>
                            </div>

                            <div class="more-less-controls mt-8">
                                <button
                                    class="btn-toggle text-primary dark:text-dark-primary text-sm font-medium inline-flex items-center hover:underline"
                                    id="more-skills-btn" aria-expanded="false" aria-controls="skills-list-hidden">
                                    <i class="fas fa-chevron-down mr-1 text-xs"></i> Show More Skills
                                </button>
                                <button
                                    class="btn-toggle hidden text-primary dark:text-dark-primary text-sm font-medium inline-flex items-center hover:underline"
                                    id="less-skills-btn" aria-expanded="true" aria-controls="skills-list-hidden">
                                    <i class="fas fa-chevron-up mr-1 text-xs"></i> Show Less Skills
                                </button>
                            </div>
                        </div>
                        <!-- Education Tab Panel -->
                        <div class="tab-contents hidden min-h-[250px] relative" id="education-panel" role="tabpanel"
                            aria-labelledby="education-tab" aria-hidden="true">
                            <ul class="space-y-5">
                                <li>
                                    <div
                                        class="tab-item-content pl-5 border-l-4 border-primary dark:border-dark-primary py-2 group">
                                        <a href="https://www.mitmuzaffarpur.org/mit-student/rayan-hasan/"
                                            target="_blank" rel="noopener noreferrer"
                                            class="inline-block transition-colors duration-300 group-hover:text-primary-darker dark:group-hover:text-dark-primary-darker">
                                            <strong
                                                class="block text-lg font-semibold text-text-main dark:text-dark-text-main mb-1 flex items-center">
                                                <i
                                                    class="fas fa-university mr-2 text-lg text-primary dark:text-dark-primary"></i>
                                                B.Tech - Information Technology <i
                                                    class="fas fa-link text-xs ml-2 opacity-0 group-hover:opacity-70 transition-opacity"
                                                    aria-hidden="true"></i>
                                            </strong>
                                        </a>
                                        <span class="block text-sm text-text-light dark:text-dark-text-light ml-7">MIT
                                            Muzaffarpur</span>
                                        <span
                                            class="block text-sm text-text-light dark:text-dark-text-light font-medium text-primary dark:text-dark-primary ml-7">(2023
                                            - 2027, Ongoing)</span>
                                    </div>
                                </li>
                                <li>
                                    <div
                                        class="tab-item-content pl-5 border-l-4 border-primary dark:border-dark-primary py-2">
                                        <strong
                                            class="block text-lg font-semibold text-text-main dark:text-dark-text-main mb-1 flex items-center">
                                            <i
                                                class="fas fa-graduation-cap mr-2 text-lg text-primary dark:text-dark-primary"></i>
                                            Intermediate (XII) - PCM
                                        </strong>
                                        <span class="block text-sm text-text-light dark:text-dark-text-light ml-7">St.
                                            Judes Vidyalaya, Barauni (CBSE)</span>
                                        <span class="block text-sm text-text-light dark:text-dark-text-light ml-7">Year:
                                            2023 | Percentage: 84.6%</span>
                                    </div>
                                </li>
                            </ul>
                            <ul id="education-list-hidden" class="space-y-5 mt-5">
                                <li class="hidden show-more-item">
                                    <div
                                        class="tab-item-content pl-5 border-l-4 border-secondary dark:border-dark-secondary py-2 group">
                                        <a href="https://www.shivamconvent.com/images/result/10%20ST.JUDES%20BARAUNI-min.pdf"
                                            target="_blank" rel="noopener noreferrer"
                                            class="inline-block transition-colors duration-300 group-hover:text-primary-darker dark:group-hover:text-dark-primary-darker">
                                            <strong
                                                class="block text-lg font-semibold text-text-main dark:text-dark-text-main mb-1 flex items-center">
                                                <i
                                                    class="fas fa-school mr-2 text-lg text-secondary dark:text-dark-secondary"></i>
                                                Matriculation (X) <i
                                                    class="fas fa-link text-xs ml-2 opacity-0 group-hover:opacity-70 transition-opacity"
                                                    aria-hidden="true"></i>
                                            </strong>
                                        </a>
                                        <span class="block text-sm text-text-light dark:text-dark-text-light ml-7">St.
                                            Judes Vidyalaya, Barauni (CBSE)</span>
                                        <span class="block text-sm text-text-light dark:text-dark-text-light ml-7">Year:
                                            2021 | Percentage: 91.8%</span>
                                    </div>
                                </li>
                            </ul>
                            <div class="more-less-controls mt-8">
                                <button
                                    class="btn-toggle text-primary dark:text-dark-primary text-sm font-medium inline-flex items-center hover:underline"
                                    id="more-Education-btn" aria-expanded="false" aria-controls="education-list-hidden">
                                    <i class="fas fa-chevron-down mr-1 text-xs"></i> Show More Education
                                </button>
                                <button
                                    class="btn-toggle hidden text-primary dark:text-dark-primary text-sm font-medium inline-flex items-center hover:underline"
                                    id="less-Education-btn" aria-expanded="true" aria-controls="education-list-hidden">
                                    <i class="fas fa-chevron-up mr-1 text-xs"></i> Show Less Education
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Portfolio Section -->
        <section id="portfolio"
            class="py-20 md:py-28 bg-gradient-to-b from-blue-50 via-bg-light to-bg-light dark:from-gray-900/50 dark:via-dark-bg-dark dark:to-dark-bg-dark">
            <div class="container mx-auto px-4 sm:px-6 lg:px-8">
                <h2 class="subtitle text-3xl md:text-4xl text-primary dark:text-dark-primary font-semibold mb-14 md:mb-16 text-center relative pb-4 subtitle-underline animate-on-scroll animate-fade-up"
                    data-animate>
                    My Work
                </h2>

                <!-- Portfolio Filters (Container for dynamic buttons) -->
                <div id="portfolio-filters" class="flex flex-wrap justify-center gap-2 md:gap-4 mb-8 md:mb-12 animate-on-scroll animate-fade-up" data-animate data-delay="100">
                    <!-- Filter buttons will be generated here by JavaScript -->
                </div>

                <!-- Portfolio Grid (Container for dynamic items) -->
                <div id="portfolio-work-list" class="work-list grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8 md:gap-10">
                    <!-- Portfolio items will be dynamically rendered here -->
                </div>

                <!-- Portfolio Show More/Less Buttons -->
                <div class="portfolio-controls text-center mt-12 md:mt-16 animate-on-scroll animate-fade-up"
                    data-animate data-delay="300">
                    <button class="btn btn-secondary hidden" id="more-btn" <!-- Initially hidden, JS will show if needed -->
                        aria-label="Show more projects" aria-expanded="false">
                        <i class="fas fa-chevron-down mr-2 text-sm"></i> See More Projects
                    </button>
                    <button class="btn btn-secondary hidden" id="less-btn"
                        aria-label="Show fewer projects" aria-expanded="true">
                        <i class="fas fa-chevron-up mr-2 text-sm"></i> Show Less
                    </button>
                </div>
            </div>
        </section>

        <!-- Project Details Modal -->
        <div id="project-modal" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="modal-title"
            aria-hidden="true" tabindex="-1">
            <div class="modal-content" role="document">
                <button id="modal-close-button" onclick="closeProjectModal()"
                    class="absolute top-4 right-4 text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300 transition-colors duration-200 focus-visible:ring-offset-bg-surface dark:focus-visible:ring-offset-dark-bg-surface icon-interact"
                    aria-label="Close project details modal">
                    <i class="fas fa-times text-2xl"></i>
                </button>

                <h3 id="modal-title" class="text-2xl font-semibold text-primary dark:text-dark-primary mb-4">Project
                    Title</h3>
                <p id="modal-desc" class="text-text-light dark:text-dark-text-light mb-5 text-base leading-relaxed">
                    Project description goes here...</p>
                <div class="mb-5">
                    <strong class="text-text-main dark:text-dark-text-main font-medium">Technologies Used:</strong>
                    <p id="modal-tech" class="text-sm text-text-light dark:text-dark-text-light mt-1">HTML, CSS, JS</p>
                </div>
                <div id="modal-learnings-container" class="mb-5">
                    <!-- Learnings injected by JS -->
                </div>
                <div id="modal-links"
                    class="flex flex-wrap gap-3 border-t border-border-light dark:border-dark-border-dark pt-5 mt-5">
                    <!-- Links injected by JS -->
                </div>
            </div>
        </div>

        <!-- Contact Section -->
        <section id="contact"
            class="py-20 md:py-28 bg-gradient-to-br from-bg-surface via-gray-50 to-bg-surface dark:from-dark-bg-surface dark:via-gray-800/20 dark:to-dark-bg-surface">
            <div class="container mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex flex-wrap md:flex-nowrap justify-between gap-12 md:gap-16 lg:gap-20 items-start">

                    <div class="contact-left w-full md:w-2/5 lg:w-1/3 animate-on-scroll animate-slide-left"
                        data-animate>
                        <h2
                            class="subtitle text-3xl md:text-4xl text-primary dark:text-dark-primary font-semibold mb-10 md:mb-12 text-left relative pb-4 subtitle-underline-left">
                            Get In Touch
                        </h2>
                        <p class="mb-8 text-text-light dark:text-dark-text-light leading-relaxed">
                            Interested in collaborating, have a project idea, a question, or just want to connect? Feel
                            free to reach out using the form or details below.
                        </p>

                        <div class="space-y-6 mb-10">
                            <div class="contact-info flex items-center text-text-light dark:text-dark-text-light group">
                                <div
                                    class="flex-shrink-0 w-8 h-8 bg-primary/10 dark:bg-dark-primary/10 rounded-full flex items-center justify-center mr-4 transition-transform duration-300 group-hover:scale-110">
                                    <i class="fas fa-paper-plane text-primary dark:text-dark-primary text-lg"></i>
                                </div>
                                <div class="flex items-center flex-wrap">
                                    <a id="email-address" href="mailto:raiyanhasan2006@gmail.com"
                                        class="font-medium text-text-main dark:text-dark-text-main hover:text-primary dark:hover:text-dark-primary hover:underline break-all transition-colors duration-300 mr-2">raiyanhasan2006@gmail.com</a>
                                    <button id="copy-email-btn" aria-label="Copy email address"
                                        title="Copy email address"
                                        class="text-text-light dark:text-dark-text-light hover:text-primary dark:hover:text-dark-primary text-sm transition-colors duration-200 icon-interact">
                                        <i class="far fa-copy"></i>
                                    </button>
                                    <span id="copy-feedback"
                                        class="text-xs text-green-600 dark:text-green-400 ml-2 opacity-0 transition-opacity duration-300"
                                        aria-live="polite">Copied!</span>
                                </div>
                            </div>
                            <div class="contact-info flex items-center text-text-light dark:text-dark-text-light group">
                                <div
                                    class="flex-shrink-0 w-8 h-8 bg-primary/10 dark:bg-dark-primary/10 rounded-full flex items-center justify-center mr-4 transition-transform duration-300 group-hover:scale-110">
                                    <i class="fas fa-map-marker-alt text-primary dark:text-dark-primary text-lg"></i>
                                </div>
                                <span class="text-text-main dark:text-dark-text-main">Muzaffarpur, Bihar, India</span>
                            </div>
                        </div>

                        <div class="mb-10">
                            <h3 class="text-lg font-medium text-text-main dark:text-dark-text-main mb-4">Connect with me
                            </h3>
                            <div class="social-icons flex space-x-5">
                                <a href="https://www.hackerrank.com/profile/raiyanhasan2006" target="_blank"
                                    rel="noopener noreferrer" title="Hackerrank" aria-label="My Hackerrank profile"
                                    class="text-gray-500 dark:text-gray-400 hover:text-[#2ec866] text-3xl transition-all duration-300 ease-in-out icon-interact"><i
                                        class="fab fa-hackerrank"></i></a>
                                <a href="https://www.linkedin.com/in/hasanraiyan/" target="_blank"
                                    rel="noopener noreferrer" title="LinkedIn" aria-label="My LinkedIn profile"
                                    class="text-gray-500 dark:text-gray-400 hover:text-primary dark:hover:text-dark-primary text-3xl transition-all duration-300 ease-in-out icon-interact"><i
                                        class="fab fa-linkedin"></i></a>
                                <a href="https://github.com/hasanraiyan" target="_blank" rel="noopener noreferrer"
                                    title="Github" aria-label="My Github profile"
                                    class="text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white text-3xl transition-all duration-300 ease-in-out icon-interact"><i
                                        class="fab fa-github"></i></a>
                            </div>
                        </div>

                        <div>
                            <a href="./resume/Raiyan_Hasan_Resume.pdf" download="Raiyan_Hasan_Resume.pdf"
                                class="btn btn-secondary inline-flex items-center"
                                aria-label="Download my resume in PDF format"> <!-- Check path -->
                                <i class="fas fa-download mr-2"></i> Download CV
                            </a>
                        </div>
                    </div>

                    <div class="contact-right w-full md:w-3/5 lg:w-2/3 animate-on-scroll animate-slide-right"
                        data-animate>
                        <div
                            class="bg-white dark:bg-dark-bg-surface-card border border-border-light/50 dark:border-dark-border-dark/50 rounded-xl p-6 md:p-10 shadow-lg dark:shadow-dark-bg-dark/50">
                            <h3 class="text-2xl md:text-3xl font-semibold text-text-main dark:text-dark-text-main mb-8">
                                Send me a message</h3>

                            <!-- Updated Form for Netlify -->
                            <form id="contact-form" autocomplete="on" class="w-full space-y-6" aria-busy="false"
                                  novalidate data-netlify="true" name="contact" method="POST">
                                <!-- Hidden input for Netlify form name -->
                                <input type="hidden" name="form-name" value="contact" />
                                <div class="relative">
                                    <span
                                        class="absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 dark:text-gray-500 text-lg pointer-events-none"><i
                                            class="far fa-user"></i></span>
                                    <input type="text" name="username" placeholder="Your Name" required
                                        aria-label="Your Name" class="w-full bg-gray-50 dark:bg-dark-bg-input border border-border-light dark:border-dark-border-dark rounded-lg p-4 pl-12 text-text-main dark:text-dark-text-main placeholder-gray-400 dark:placeholder-gray-500 transition-all duration-300 ease-in-out
                                          focus:outline-none focus:ring-2 focus:ring-primary/30 focus:border-primary dark:focus:ring-dark-primary/30 dark:focus:border-dark-primary
                                          invalid:border-pink-500 dark:invalid:border-pink-600 invalid:text-pink-600 dark:invalid:text-pink-500
                                          invalid:focus:ring-pink-500/50 dark:invalid:focus:ring-pink-600/50">
                                </div>

                                <div class="relative">
                                    <span
                                        class="absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 dark:text-gray-500 text-lg pointer-events-none"><i
                                            class="far fa-envelope"></i></span>
                                    <input type="email" name="email" placeholder="Your Email" required
                                        aria-label="Your Email" class="w-full bg-gray-50 dark:bg-dark-bg-input border border-border-light dark:border-dark-border-dark rounded-lg p-4 pl-12 text-text-main dark:text-dark-text-main placeholder-gray-400 dark:placeholder-gray-500 transition-all duration-300 ease-in-out
                                          focus:outline-none focus:ring-2 focus:ring-primary/30 focus:border-primary dark:focus:ring-dark-primary/30 dark:focus:border-dark-primary
                                          invalid:border-pink-500 dark:invalid:border-pink-600 invalid:text-pink-600 dark:invalid:text-pink-500
                                          invalid:focus:ring-pink-500/50 dark:invalid:focus:ring-pink-600/50">
                                </div>

                                <div class="relative">
                                    <span
                                        class="absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 dark:text-gray-500 text-lg pointer-events-none"><i
                                            class="fas fa-phone-alt"></i></span>
                                    <input type="tel" name="phone" placeholder="Your Phone (Optional)"
                                        aria-label="Your Phone Number"
                                        class="w-full bg-gray-50 dark:bg-dark-bg-input border border-border-light dark:border-dark-border-dark rounded-lg p-4 pl-12 text-text-main dark:text-dark-text-main placeholder-gray-400 dark:placeholder-gray-500 transition-all duration-300 ease-in-out
                                          focus:outline-none focus:ring-2 focus:ring-primary/30 focus:border-primary dark:focus:ring-dark-primary/30 dark:focus:border-dark-primary">
                                </div>

                                <div class="relative">
                                    <span
                                        class="absolute left-4 top-5 text-gray-400 dark:text-gray-500 text-lg pointer-events-none"><i
                                            class="far fa-comment-dots"></i></span>
                                    <textarea name="message" placeholder="Your Message" rows="5" required
                                        aria-label="Your Message"
                                        class="w-full bg-gray-50 dark:bg-dark-bg-input border border-border-light dark:border-dark-border-dark rounded-lg p-4 pl-12 text-text-main dark:text-dark-text-main placeholder-gray-400 dark:placeholder-gray-500 resize-y min-h-[140px] transition-all duration-300 ease-in-out
                                          focus:outline-none focus:ring-2 focus:ring-primary/30 focus:border-primary dark:focus:ring-dark-primary/30 dark:focus:border-dark-primary
                                          invalid:border-pink-500 dark:invalid:border-pink-600 invalid:text-pink-600 dark:invalid:text-pink-500
                                          invalid:focus:ring-pink-500/50 dark:invalid:focus:ring-pink-600/50"></textarea>
                                </div>

                                <div class="pt-2">
                                    <button type="submit"
                                        class="btn btn-primary px-8 py-3 w-full sm:w-auto group flex items-center justify-center relative transition-all duration-300 ease-in-out disabled:opacity-50 disabled:cursor-not-allowed">
                                        <span class="submit-text inline-block">Send Message</span>
                                        <i
                                            class="submit-icon fas fa-paper-plane ml-2 transition-transform duration-300 group-hover:translate-x-1 group-focus:translate-x-1"></i>
                                        <span
                                            class="loading-spinner absolute inset-0 flex items-center justify-center bg-primary dark:bg-dark-primary opacity-0 transition-opacity duration-300 pointer-events-none rounded-full">
                                            <svg class="animate-spin h-5 w-5 text-white"
                                                xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                                                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor"
                                                    stroke-width="4"></circle>
                                                <path class="opacity-75" fill="currentColor"
                                                    d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z">
                                                </path>
                                            </svg>
                                        </span>
                                    </button>
                                </div>
                            </form>

                            <div id="msg"
                                class="mt-6 p-4 rounded-md text-center font-medium text-sm transition-all duration-300 opacity-0 transform translate-y-2"
                                role="alert" aria-live="polite" style="visibility: hidden;">
                                <!-- Feedback Message Area -->
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </section>

    </main>

    <!-- Footer -->
    <footer
        class="copyright bg-text-main dark:bg-dark-bg-surface text-gray-400 dark:text-dark-text-light text-center py-6 mt-20 md:mt-28 text-sm transition-colors duration-300 ease-in-out">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8 relative">
            <p>© <span id="current-year"></span> Raiyan Hasan. Crafted with <i
                    class="fas fa-heart text-red-500 animate-pulse"></i> using Tailwind CSS & JS.</p>
            <button id="back-to-top" onclick="scrollToTop()"
                class="back-to-top fixed bottom-6 right-6 bg-primary dark:bg-dark-primary text-white w-10 h-10 rounded-full flex items-center justify-center text-lg shadow-lg hover:bg-primary-darker dark:hover:bg-dark-primary-darker transition-all duration-300 opacity-0 pointer-events-none transform translate-y-4 icon-interact"
                aria-label="Back to top" aria-hidden="true">
                <i class="fas fa-arrow-up"></i>
            </button>
        </div>
    </footer>

    <!-- Main JavaScript (Updated with Dynamic Portfolio) -->
    <script>
        // --- Global Constants ---
        const SCROLL_OFFSET = 80;
        const ANIMATION_DELAY_STEP = 100; // Stagger delay for initial portfolio items
        const SHOW_MORE_STAGGER = 50; // ms delay between each new item appearing
        const FOCUSABLE_MODAL_ELEMENTS = 'button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])';
        const PORTFOLIO_INITIAL_VISIBLE_COUNT = 3; // Number of portfolio items visible initially

        // --- Portfolio Project Data ---
        const portfolioData = [
            {
                id: 'mit-clone',
                title: 'MIT Muzaffarpur Clone',
                imageSrc: './images/work-5.png',
                imageAlt: 'MIT Muzaffarpur Clone',
                shortDesc: 'Responsive university website clone.',
                modalTitle: 'MIT Muzaffarpur Clone',
                modalDesc: 'A responsive clone of the official MIT Muzaffarpur website, built using HTML, CSS (Tailwind), and JavaScript. Focused on replicating the design, layout, and key interactive elements.',
                modalTech: ['HTML', 'Tailwind CSS', 'JavaScript'],
                modalLearnings: 'Practiced complex layouts with Tailwind, implementing responsive navigation, and mimicking existing UI patterns accurately.',
                liveLink: 'https://hasanraiyan.github.io/MIT',
                repoLink: null, // Use null if no link
                tags: ['Tailwind', 'JavaScript', 'Clone', 'Frontend'],
                initiallyHidden: false,
                animationDelay: 0
            },
            {
                id: 'ttt-ai',
                title: 'Tic Tac Toe (vs AI)',
                imageSrc: './images/work-1.png',
                imageAlt: 'Tic Tac Toe vs AI',
                shortDesc: 'Play against the computer.',
                modalTitle: 'Tic Tac Toe (vs AI)',
                modalDesc: 'Classic Tic Tac Toe game where you can play against a simple computer opponent implemented with JavaScript logic. Includes win detection and game reset functionality.',
                modalTech: ['HTML', 'CSS', 'JavaScript'],
                modalLearnings: 'Implemented game logic, including win condition checks and a basic AI opponent strategy using vanilla JavaScript.',
                liveLink: 'https://hasanraiyan.github.io/projects/tik%20tak%20toe/index.html',
                repoLink: null,
                tags: ['JavaScript', 'Game', 'AI', 'Frontend'],
                initiallyHidden: false,
                animationDelay: 100
            },
            {
                id: 'calculator',
                title: 'Web Calculator',
                imageSrc: './images/work-2.png',
                imageAlt: 'Web Calculator',
                shortDesc: 'Functional calculator for quick math.',
                modalTitle: 'Web Calculator',
                modalDesc: 'A functional web-based calculator built with HTML, CSS, and JavaScript. It handles basic arithmetic operations (+, -, *, /) and includes display updates and clear functionality.',
                modalTech: ['HTML', 'CSS', 'JavaScript'],
                modalLearnings: 'Focused on DOM manipulation with JavaScript to handle user input, update the display, and perform calculations.',
                liveLink: 'https://hasanraiyan.github.io/projects/calculator/index.html',
                repoLink: null,
                tags: ['JavaScript', 'Utility', 'Frontend'],
                initiallyHidden: false,
                animationDelay: 200
            },
            {
                id: 'ttt-pvp',
                title: 'Tic Tac Toe (PvP)',
                imageSrc: './images/work-3.png',
                imageAlt: 'Tic Tac Toe PvP',
                shortDesc: 'Play head-to-head with a friend.',
                modalTitle: 'Tic Tac Toe (Player vs Player)',
                modalDesc: 'Play the classic Tic Tac Toe game head-to-head against another player on the same device. Simple, fun, and includes turn indicators and win detection.',
                modalTech: ['HTML', 'CSS', 'JavaScript'],
                modalLearnings: 'Refined basic game logic and state management for a two-player experience.',
                liveLink: 'https://hasanraiyan.github.io/TikTakToe/',
                repoLink: 'https://github.com/hasanraiyan/TikTakToe',
                tags: ['JavaScript', 'Game', 'Frontend'],
                initiallyHidden: true, // Start hidden for "Show More"
                animationDelay: 0 // Delay handled by show more logic
            },
            {
                id: 'pm-ui',
                title: 'Project Management UI',
                imageSrc: './images/work-4.png',
                imageAlt: 'Project Management UI',
                shortDesc: 'Conceptual UI for project tracking.',
                modalTitle: 'Project Management UI (Concept)',
                modalDesc: 'A conceptual user interface design for a project management dashboard. Focuses on clean layout, component structure (cards, sidebars), and visual hierarchy using Tailwind CSS. This is primarily a design showcase.',
                modalTech: ['HTML', 'Tailwind CSS'],
                modalLearnings: 'Practiced translating UI concepts into functional HTML/CSS using Tailwind utilities for layout and styling. Focused on component-based structure.',
                liveLink: 'https://hasanraiyan.github.io/projects/',
                repoLink: null,
                tags: ['Tailwind', 'UI/UX', 'Design', 'Frontend'],
                initiallyHidden: true,
                animationDelay: 0
            },
            {
                id: 'notejs',
                title: 'NoteJS App',
                imageSrc: 'https://github.com/hasanraiyan/NoteJS/raw/main/assets/images/apps/HomeScreen.png',
                imageAlt: 'NoteJS App Home Screen',
                shortDesc: 'Simple notes app built with React Native.',
                modalTitle: 'NoteJS - Simple Notes App',
                modalDesc: 'NoteJS is a basic notes application built with React Native and Expo. It allows users to create, edit, delete, and save notes locally on their device.',
                modalTech: ['React Native', 'Expo', 'JavaScript'],
                modalLearnings: 'Developed a cross-platform mobile app, implemented local data storage using AsyncStorage, managed component state for CRUD operations (Create, Read, Update, Delete).',
                liveLink: null,
                repoLink: 'https://github.com/hasanraiyan/NoteJS',
                tags: ['React Native', 'Mobile', 'JavaScript'],
                initiallyHidden: true,
                animationDelay: 0
            },
            {
                id: 'dostify',
                title: 'Dostify AI Companion',
                imageSrc: 'https://dostify-climb.vercel.app/images/app-icon.png',
                imageAlt: 'Dostify AI Companion Landing Page',
                shortDesc: 'AI chatbot providing support for students.',
                modalTitle: 'Dostify - AI Student Companion',
                modalDesc: 'An AI-powered chatbot designed as a friendly companion for students, helping them navigate academic pressure, mental health challenges, and career uncertainty with personalized support, resources, and conversation starters.',
                modalTech: ['React', 'Next.js', 'Tailwind CSS', 'AI Integration', 'Chatbot'],
                modalLearnings: 'Developed an interactive chatbot interface, integrated with an AI backend (presumed), designed user journeys for various student needs (academic, mental health, career), built a responsive landing page showcasing features and benefits.',
                liveLink: 'https://dostify-climb.vercel.app/',
                repoLink: null,
                tags: ['React', 'Next.js', 'Tailwind', 'AI', 'Chatbot', 'Frontend'],
                initiallyHidden: true,
                animationDelay: 0
            },
            // Add more projects here in the same format
        ];

        // --- Function to Create Project HTML Element ---
        function createProjectElement(project) {
            const workItem = document.createElement('div');
            // Base classes + hidden/show-more based on data
            workItem.className = `work-item group relative rounded-xl overflow-hidden shadow-lg bg-bg-surface dark:bg-dark-bg-surface transform transition duration-300 hover:shadow-2xl dark:hover:shadow-dark-bg-dark/50 hover:-translate-y-2 ${project.initiallyHidden ? 'hidden show-more-item' : 'animate-on-scroll animate-fade-up'}`; // Add hidden/show-more classes or animation classes

            // Add data attributes for modal and filtering
            workItem.dataset.modalTitle = project.modalTitle;
            workItem.dataset.modalDesc = project.modalDesc;
            workItem.dataset.modalTech = project.modalTech.join(', '); // Join array for display
            workItem.dataset.modalLearnings = project.modalLearnings || '';
            workItem.dataset.modalLive = project.liveLink || '';
            workItem.dataset.modalRepo = project.repoLink || '';
            workItem.dataset.tags = project.tags.join(',').toLowerCase(); // Store tags for filtering
            workItem.dataset.id = project.id; // Store ID if needed later

            // Add animation attributes only if not initially hidden
             if (!project.initiallyHidden) {
                 workItem.setAttribute('data-animate', ''); // Mark for scroll animation observer
                 workItem.dataset.delay = project.animationDelay; // Apply initial animation delay
             }


            // Add Tilt attribute
            workItem.setAttribute('data-tilt', '');

            // Image
            const img = document.createElement('img');
            img.src = project.imageSrc;
            img.alt = project.imageAlt;
            img.className = 'w-full h-72 sm:h-80 md:h-96 object-cover object-top transition-transform duration-500 group-hover:scale-110';
            img.loading = 'lazy';
            workItem.appendChild(img);

            // Layer (Hover Effect)
            const layer = document.createElement('div');
            layer.className = 'layer'; // Layer styles are defined in CSS

            const glassEffect = document.createElement('div');
            glassEffect.className = 'glass-effect rounded-lg p-4 w-full transform transition-transform duration-500 delay-100 group-hover:scale-100 scale-95';

            const title = document.createElement('h3');
            title.className = 'text-lg sm:text-xl font-semibold text-white mb-1 sm:mb-2';
            title.textContent = project.title;
            glassEffect.appendChild(title);

            const shortDesc = document.createElement('p');
            shortDesc.className = 'text-xs sm:text-sm text-gray-100 mb-3';
            shortDesc.textContent = project.shortDesc;
            glassEffect.appendChild(shortDesc);

            const linksDiv = document.createElement('div');
            linksDiv.className = 'flex justify-center space-x-3';

            // Modal Button
            const modalButton = document.createElement('button');
            modalButton.onclick = () => openProjectModal(workItem); // Pass the element itself
            modalButton.setAttribute('aria-label', `View details for ${project.title} project`);
            modalButton.className = 'bg-white text-primary dark:text-dark-primary rounded-full w-10 h-10 sm:w-12 sm:h-12 flex items-center justify-center text-lg sm:text-xl hover:bg-accent hover:text-white dark:hover:bg-dark-accent transition-all duration-300 transform hover:scale-110 shadow-md focus-visible:ring-offset-glass-bg dark:focus-visible:ring-offset-dark-glass-bg icon-interact'; // Added icon-interact
            modalButton.innerHTML = '<i class="fas fa-info"></i>';
            linksDiv.appendChild(modalButton);

            // Live Link Button (if exists)
            if (project.liveLink) {
                const liveLink = document.createElement('a');
                liveLink.href = project.liveLink;
                liveLink.target = '_blank';
                liveLink.rel = 'noopener noreferrer';
                liveLink.setAttribute('aria-label', `View live ${project.title} project`);
                liveLink.className = 'bg-white text-primary dark:text-dark-primary rounded-full w-10 h-10 sm:w-12 sm:h-12 flex items-center justify-center text-lg sm:text-xl hover:bg-accent hover:text-white dark:hover:bg-dark-accent transition-all duration-300 transform hover:scale-110 shadow-md focus-visible:ring-offset-glass-bg dark:focus-visible:ring-offset-dark-glass-bg icon-interact'; // Added icon-interact
                liveLink.innerHTML = '<i class="fas fa-external-link-alt"></i>';
                linksDiv.appendChild(liveLink);
            }

            // Repo Link Button (if exists)
            if (project.repoLink) {
                const repoLink = document.createElement('a');
                repoLink.href = project.repoLink;
                repoLink.target = '_blank';
                repoLink.rel = 'noopener noreferrer';
                repoLink.setAttribute('aria-label', `View ${project.title} source code on Github`);
                repoLink.className = 'bg-white text-primary dark:text-dark-primary rounded-full w-10 h-10 sm:w-12 sm:h-12 flex items-center justify-center text-lg sm:text-xl hover:bg-accent hover:text-white dark:hover:bg-dark-accent transition-all duration-300 transform hover:scale-110 shadow-md focus-visible:ring-offset-glass-bg dark:focus-visible:ring-offset-dark-glass-bg icon-interact'; // Added icon-interact
                repoLink.innerHTML = '<i class="fab fa-github"></i>';
                linksDiv.appendChild(repoLink);
            }

            glassEffect.appendChild(linksDiv);
            layer.appendChild(glassEffect);
            workItem.appendChild(layer);

            return workItem;
        }

        // --- Function to Render Portfolio ---
        function renderPortfolio(projects, containerElement) {
            if (!containerElement) {
                console.error("Portfolio container not found!");
                return;
            }
            containerElement.innerHTML = ''; // Clear existing content
            projects.forEach(project => {
                const projectElement = createProjectElement(project);
                containerElement.appendChild(projectElement);
            });
        }

        // --- Function to Generate Filter Buttons ---
        function generateFilterButtons(projects, containerElement) {
            if (!containerElement) return;

            const allTags = new Set(['All']); // Start with 'All'
            // Extract unique tags, converting to title case for display
            projects.forEach(p => p.tags.forEach(tag => {
                const titleCaseTag = tag.charAt(0).toUpperCase() + tag.slice(1).toLowerCase(); // Basic title case
                 allTags.add(titleCaseTag)
             }));

            containerElement.innerHTML = ''; // Clear existing buttons

            allTags.forEach(tag => {
                const button = document.createElement('button');
                const filterValue = tag.toLowerCase(); // Use lowercase for filter value
                button.className = 'filter-btn px-4 py-1.5 rounded-full text-sm font-medium text-text-light dark:text-dark-text-light hover:bg-gray-100 dark:hover:bg-dark-bg-surface transition';
                button.dataset.filter = filterValue;
                button.textContent = tag; // Display title-cased tag

                if (tag === 'All') {
                    // Make 'All' active by default
                    button.classList.add('active', 'bg-primary/10', 'dark:bg-dark-primary/10', 'text-primary', 'dark:text-dark-primary', 'font-semibold');
                    button.classList.remove('text-text-light', 'dark:text-dark-text-light', 'hover:bg-gray-100', 'dark:hover:bg-dark-bg-surface');
                }

                button.addEventListener('click', () => {
                    filterPortfolio(filterValue); // Call filter function on click
                });
                containerElement.appendChild(button);
            });
        }


        // --- DOM Element Cache ---
        const Cache = {
            htmlElement: document.documentElement,
            preloader: document.getElementById('preloader'),
            sidemenu: document.getElementById("sidemenu"),
            siteHeader: document.getElementById("site-header"),
            backToTopButton: document.getElementById('back-to-top'),
            contactForm: document.getElementById('contact-form'),
            formMsg: document.getElementById('msg'),
            submitButton: document.querySelector('#contact-form button[type="submit"]'),
            submitButtonText: document.querySelector('#contact-form .submit-text'),
            submitButtonIcon: document.querySelector('#contact-form .submit-icon'),
            loadingSpinner: document.querySelector('#contact-form .loading-spinner'),
            tabLinks: document.querySelectorAll(".tab-links"),
            tabContents: document.querySelectorAll(".tab-contents"),
            navLinks: document.querySelectorAll('#main-nav ul:not(#sidemenu) .nav-link'),
            mobileMenuButton: document.querySelector('.icon-menu'),
            mobileMenuCloseButton: document.querySelector('#sidemenu .icon-close'),
            themeToggleButtons: document.querySelectorAll('#theme-toggle, #theme-toggle-mobile'),
            themeToggleDarkIcons: document.querySelectorAll('#theme-toggle-dark-icon, #theme-toggle-dark-icon-mobile'),
            themeToggleLightIcons: document.querySelectorAll('#theme-toggle-light-icon, #theme-toggle-light-icon-mobile'),
            portfolioList: document.getElementById('portfolio-work-list'), // Updated ID
            portfolioFilters: document.getElementById('portfolio-filters'),
            portfolioMoreBtn: document.getElementById('more-btn'),
            portfolioLessBtn: document.getElementById('less-btn'),
            projectModal: document.getElementById('project-modal'),
            modalOverlay: document.getElementById('project-modal'),
            modalContent: document.querySelector('#project-modal .modal-content'),
            modalTitle: document.getElementById('modal-title'),
            modalDesc: document.getElementById('modal-desc'),
            modalTech: document.getElementById('modal-tech'),
            modalLearningsContainer: document.getElementById('modal-learnings-container'),
            modalLinks: document.getElementById('modal-links'),
            modalCloseButton: document.getElementById('modal-close-button'),
            skillsHiddenWrapper: document.getElementById('skills-list-hidden'),
            educationHiddenWrapper: document.getElementById('education-list-hidden'),
            skillsMoreBtn: document.getElementById('more-skills-btn'),
            skillsLessBtn: document.getElementById('less-skills-btn'),
            educationMoreBtn: document.getElementById('more-Education-btn'),
            educationLessBtn: document.getElementById('less-Education-btn'),
            copyEmailBtn: document.getElementById('copy-email-btn'),
            emailAddressSpan: document.getElementById('email-address'),
            copyFeedbackSpan: document.getElementById('copy-feedback'),
        };

        // --- State Variables ---
        let isModalOpen = false;
        let focusedElementBeforeModal = null;
        let currentPortfolioFilter = 'all'; // Keep track of the current filter
        let portfolioShowAll = false; // Keep track if all items (matching filter) are shown

        // --- Utility Functions ---
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => { clearTimeout(timeout); func(...args); };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        // --- Theme Management ---
        function updateThemeUI(isDarkMode) {
            Cache.themeToggleDarkIcons.forEach(icon => icon.classList.toggle('hidden', !isDarkMode));
            Cache.themeToggleLightIcons.forEach(icon => icon.classList.toggle('hidden', isDarkMode));
            Cache.themeToggleButtons.forEach(button => button.setAttribute('aria-pressed', isDarkMode.toString()));
        }
        function applyTheme(isDarkMode) {
            Cache.htmlElement.classList.toggle('dark', isDarkMode);
            localStorage.theme = isDarkMode ? 'dark' : 'light';
            updateThemeUI(isDarkMode);
        }
        function toggleTheme() {
            const isCurrentlyDark = Cache.htmlElement.classList.contains('dark');
            applyTheme(!isCurrentlyDark);
        }
        function initializeTheme() {
            const isDarkMode = localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches);
            Cache.htmlElement.classList.toggle('dark', isDarkMode); // Apply class before UI update
            updateThemeUI(isDarkMode);
            Cache.themeToggleButtons.forEach(btn => btn.addEventListener('click', toggleTheme));
        }

        // --- Tabbed Interface (About Section) ---
        function opentab(event, tabpanelId) {
            const targetPanel = document.getElementById(tabpanelId);
            if (!targetPanel) return;

            // Update tab button states
            Cache.tabLinks.forEach(tablink => {
                const isSelected = tablink === event.currentTarget;
                tablink.classList.toggle("active-link", isSelected);
                tablink.setAttribute('aria-selected', isSelected.toString());
                tablink.setAttribute('tabindex', isSelected ? '0' : '-1');
            });

            // Update tab panel visibility with transition
            Cache.tabContents.forEach(tabcontent => {
                const isTargetPanel = tabcontent.id === tabpanelId;
                 tabcontent.classList.toggle("active-tab", isTargetPanel); // Add active class for reference
                 tabcontent.classList.toggle("hidden", !isTargetPanel); // Use hidden for control
                 tabcontent.setAttribute('aria-hidden', (!isTargetPanel).toString());
                 // Opacity transition is handled by CSS
            });

            // Focus management for keyboard users
            if (event.type === 'keydown' && (event.key === 'Enter' || event.key === ' ')) {
                event.currentTarget.focus();
            }
        }


        // --- Mobile Menu ---
        function openmenu() {
            if (!Cache.sidemenu) return;
            Cache.sidemenu.classList.remove('translate-x-full');
            Cache.sidemenu.classList.add('translate-x-0');
            Cache.sidemenu.setAttribute('aria-hidden', 'false');
            Cache.mobileMenuButton?.setAttribute('aria-expanded', 'true');
            document.body.style.overflow = 'hidden'; // Prevent background scroll
            trapFocus(Cache.sidemenu); // Trap focus inside menu
        }
        function closemenu() {
            if (!Cache.sidemenu) return;
            Cache.sidemenu.classList.remove('translate-x-0');
            Cache.sidemenu.classList.add('translate-x-full');
            Cache.sidemenu.setAttribute('aria-hidden', 'true');
            Cache.mobileMenuButton?.setAttribute('aria-expanded', 'false');
            document.body.style.overflow = ''; // Restore background scroll
            releaseFocus(Cache.sidemenu); // Release focus trap
            Cache.mobileMenuButton?.focus(); // Return focus to the menu button
        }

        // --- Contact Form Submission (Simulated / Placeholder for Netlify) ---
        function showFeedback(message, isError = false) {
            if (!Cache.formMsg) return;
            Cache.formMsg.textContent = message;
            Cache.formMsg.className = 'mt-6 p-4 rounded-md text-center font-medium text-sm transition-all duration-300 opacity-100 transform translate-y-0';
            if (isError) {
                Cache.formMsg.classList.add('bg-red-100', 'border', 'border-red-300', 'text-red-800', 'dark:bg-red-900/30', 'dark:border-red-700', 'dark:text-red-300');
            } else {
                Cache.formMsg.classList.add('bg-green-100', 'border', 'border-green-300', 'text-green-800', 'dark:bg-green-900/30', 'dark:border-green-700', 'dark:text-green-300');
            }
            Cache.formMsg.style.visibility = 'visible';
            Cache.formMsg.setAttribute('aria-hidden', 'false');
        }
        function hideFeedback() {
            if (!Cache.formMsg) return;
            Cache.formMsg.textContent = '';
            Cache.formMsg.className = 'mt-6 p-4 rounded-md text-center font-medium text-sm transition-all duration-300 opacity-0 transform translate-y-2';
            Cache.formMsg.style.visibility = 'hidden';
            Cache.formMsg.setAttribute('aria-hidden', 'true');
        }
        function setLoading(isLoading) {
            if (!Cache.submitButton || !Cache.submitButtonText || !Cache.submitButtonIcon || !Cache.loadingSpinner || !Cache.contactForm) return;

            if (isLoading) {
                Cache.submitButton.disabled = true;
                Cache.contactForm.setAttribute('aria-busy', 'true');
                Cache.submitButtonText.style.opacity = '0'; Cache.submitButtonIcon.style.opacity = '0';
                Cache.submitButtonText.style.visibility = 'hidden'; Cache.submitButtonIcon.style.visibility = 'hidden';
                Cache.loadingSpinner.style.opacity = '1'; Cache.loadingSpinner.style.pointerEvents = 'auto';
                hideFeedback();
            } else {
                Cache.submitButton.disabled = false;
                Cache.contactForm.setAttribute('aria-busy', 'false');
                Cache.submitButtonText.style.opacity = '1'; Cache.submitButtonIcon.style.opacity = '1';
                Cache.submitButtonText.style.visibility = 'visible'; Cache.submitButtonIcon.style.visibility = 'visible';
                Cache.loadingSpinner.style.opacity = '0'; Cache.loadingSpinner.style.pointerEvents = 'none';
            }
        }

        async function handleFormSubmit(e) {
             // Handle Netlify submission directly via HTML attributes
             // JS only handles validation, loading state, and feedback simulation
             e.preventDefault(); // Prevent default submission initially

             if (!Cache.contactForm) return;

             // Basic client-side validation check
            if (!Cache.contactForm.checkValidity()) {
                showFeedback('Please fill out all required fields correctly.', true);
                const firstInvalid = Cache.contactForm.querySelector(':invalid');
                if (firstInvalid) firstInvalid.focus();
                return;
            }

            setLoading(true);

            // Prepare data for Netlify AJAX submission
            const formData = new FormData(Cache.contactForm);
            const formAction = Cache.contactForm.getAttribute('action') || '/'; // Default or specific action

            fetch(formAction, {
              method: "POST",
              headers: { "Accept": "application/x-www-form-urlencoded" },
              body: new URLSearchParams(formData).toString(),
            })
            .then(() => {
                // Success
                showFeedback('Thank you for your message! I will get back to you soon.');
                Cache.contactForm.reset();
                setTimeout(hideFeedback, 6000);
            })
            .catch((error) => {
                // Error
                console.error('Form submission error:', error);
                showFeedback('There was a problem sending your message. Please try again.', true);
             })
            .finally(() => {
                setLoading(false);
            });
        }

        // --- Show More/Less Functionality (Generic + Portfolio Specific) ---
         function setupToggle(wrapper, itemSelector, moreBtn, lessBtn, initialVisibleCount) {
            if (!wrapper || !moreBtn || !lessBtn) {
                console.warn(`Toggle setup failed: Elements missing for wrapper ${wrapper?.id}.`);
                return;
            }

            const items = Array.from(wrapper.querySelectorAll(`:scope > ${itemSelector}`));
            const totalItems = items.length;

            if (totalItems <= initialVisibleCount) {
                items.forEach(item => item.classList.remove('hidden'));
                moreBtn.classList.add('hidden');
                lessBtn.classList.add('hidden');
                return;
            }

            const wrapperId = wrapper.id;
            if (wrapperId) {
                moreBtn.setAttribute('aria-controls', wrapperId);
                lessBtn.setAttribute('aria-controls', wrapperId);
            }

            const updateVisibility = (showAll) => {
                const prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;

                items.forEach((item, index) => {
                    const shouldBeHidden = index >= initialVisibleCount && !showAll;

                    if (!shouldBeHidden && item.classList.contains('hidden')) {
                        item.classList.remove('hidden');
                        if (!prefersReducedMotion && item.classList.contains('show-more-item')) {
                            item.classList.add('animate-in');
                             item.style.animationDelay = `${(index - initialVisibleCount) * SHOW_MORE_STAGGER}ms`;
                            item.addEventListener('animationend', () => {
                                item.classList.remove('animate-in');
                                item.style.animationDelay = '';
                            }, { once: true });
                        } else {
                            item.style.opacity = '1'; item.style.transform = 'translateY(0)';
                        }
                    } else if (shouldBeHidden && !item.classList.contains('hidden')) {
                        item.classList.add('hidden');
                        item.classList.remove('animate-in'); item.style.animationDelay = '';
                        item.style.opacity = ''; item.style.transform = '';
                    }
                });

                moreBtn.classList.toggle('hidden', showAll);
                lessBtn.classList.toggle('hidden', !showAll);
                moreBtn.setAttribute('aria-expanded', showAll.toString());
                lessBtn.setAttribute('aria-expanded', showAll.toString());

                if (!showAll && document.activeElement === lessBtn) {
                    setTimeout(() => moreBtn.focus({ preventScroll: true }), 50);
                }
            };

            items.forEach((item, index) => item.classList.toggle('hidden', index >= initialVisibleCount));
            moreBtn.classList.remove('hidden');
            lessBtn.classList.add('hidden');
            moreBtn.setAttribute('aria-expanded', 'false');
            lessBtn.setAttribute('aria-expanded', 'false');

            moreBtn.onclick = () => updateVisibility(true);
            lessBtn.onclick = () => updateVisibility(false);
        }


        // This function now just applies visibility based on count to *already visible* items
        function applyPortfolioShowMoreVisibility() {
            if (!Cache.portfolioList || !Cache.portfolioMoreBtn || !Cache.portfolioLessBtn) return;

            const visibleItems = Array.from(Cache.portfolioList.querySelectorAll('.work-item:not(.hidden)')); // Select only items currently visible (matching filter)
            const totalVisibleItems = visibleItems.length;
            const numberToShow = portfolioShowAll ? Infinity : PORTFOLIO_INITIAL_VISIBLE_COUNT;

            const prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;

            visibleItems.forEach((item, index) => {
                const shouldBeHiddenByShowLess = index >= numberToShow;

                if (shouldBeHiddenByShowLess) {
                    // Hide item due to show/less limit
                     item.classList.add('show-more-item-hidden'); // Apply hiding class
                     item.style.opacity = '0';
                     item.style.transform = 'translateY(10px)'; // Consistent hidden style
                     item.classList.remove('animate-in');
                     item.style.animationDelay = '';
                     item.setAttribute('aria-hidden', 'true'); // Hide from screen readers
                } else {
                    // Show item (it passed filter and is within limit)
                    const wasHiddenByShowLess = item.classList.contains('show-more-item-hidden');
                    item.classList.remove('show-more-item-hidden'); // Ensure hiding class is removed
                    item.removeAttribute('aria-hidden');

                    // Only animate if it was *specifically* hidden by show/less before and now revealed
                    if (wasHiddenByShowLess && item.classList.contains('show-more-item') && !prefersReducedMotion) {
                        item.style.opacity = '0';
                        item.style.transform = 'translateY(10px)';
                        void item.offsetWidth; // Reflow
                        item.classList.add('animate-in');
                        item.style.animationDelay = `${(index - PORTFOLIO_INITIAL_VISIBLE_COUNT) * SHOW_MORE_STAGGER}ms`;
                         item.addEventListener('animationend', () => {
                            item.classList.remove('animate-in');
                            item.style.opacity = ''; item.style.transform = ''; item.style.animationDelay = '';
                        }, { once: true });
                    } else {
                         // Ensure visible style if not animating
                        item.style.opacity = '1';
                        item.style.transform = 'translateY(0)';
                    }
                }
            });

            // Update button visibility and ARIA states
            const canShowMore = totalVisibleItems > PORTFOLIO_INITIAL_VISIBLE_COUNT;
            Cache.portfolioMoreBtn.classList.toggle('hidden', portfolioShowAll || !canShowMore);
            Cache.portfolioLessBtn.classList.toggle('hidden', !portfolioShowAll || !canShowMore);
             Cache.portfolioMoreBtn.setAttribute('aria-expanded', portfolioShowAll.toString());
             Cache.portfolioLessBtn.setAttribute('aria-expanded', portfolioShowAll.toString());
             // Make sure buttons are interactive only when visible
             Cache.portfolioMoreBtn.style.pointerEvents = (portfolioShowAll || !canShowMore) ? 'none' : 'auto';
             Cache.portfolioLessBtn.style.pointerEvents = (!portfolioShowAll || !canShowMore) ? 'none' : 'auto';
        }


        // --- Portfolio Filtering (Updated) ---
        function filterPortfolio(filter) {
            if (!Cache.portfolioList || !Cache.portfolioFilters) return;
            currentPortfolioFilter = filter.toLowerCase(); // Store current filter

            const workItems = Cache.portfolioList.querySelectorAll('.work-item');
            const filterButtons = Cache.portfolioFilters.querySelectorAll('.filter-btn');

            // Update button active states
            filterButtons.forEach(btn => {
                const isActive = btn.dataset.filter === currentPortfolioFilter;
                btn.classList.toggle('active', isActive);
                btn.classList.toggle('bg-primary/10', isActive);
                btn.classList.toggle('dark:bg-dark-primary/10', isActive);
                btn.classList.toggle('text-primary', isActive);
                btn.classList.toggle('dark:text-dark-primary', isActive);
                btn.classList.toggle('font-semibold', isActive);
                btn.classList.toggle('text-text-light', !isActive);
                btn.classList.toggle('dark:text-dark-text-light', !isActive);
                btn.classList.toggle('hover:bg-gray-100', !isActive);
                btn.classList.toggle('dark:hover:bg-dark-bg-surface', !isActive);
            });

            workItems.forEach(item => {
                const tags = item.dataset.tags?.split(',') || [];
                const match = currentPortfolioFilter === 'all' || tags.includes(currentPortfolioFilter);

                // Reset show/less specific hiding first
                item.classList.remove('show-more-item-hidden');
                item.removeAttribute('aria-hidden'); // Ensure not hidden by show/less initially

                // Apply filtering visibility (using 'hidden' utility class from Tailwind)
                item.classList.toggle('hidden', !match);

                 // Set initial styles for transition (will be overridden by applyPortfolioShowMoreVisibility if needed)
                 if (match) {
                     item.style.opacity = '1';
                     item.style.transform = 'scale(1)'; // Use scale or translateY
                     item.style.pointerEvents = 'auto';
                 } else {
                     item.style.opacity = '0';
                     item.style.transform = 'scale(0.95)';
                     item.style.pointerEvents = 'none';
                 }
                 item.classList.remove('animate-in'); // Stop any ongoing reveal animation
                 item.style.animationDelay = ''; // Reset delay
            });

            // Reset show/less state and apply visibility limits to the *filtered* items
            portfolioShowAll = false; // Always reset to show initial amount after filtering
            applyPortfolioShowMoreVisibility();

            // Re-run scroll animations check for items that became visible due to filtering
            // The observer should pick them up automatically if they are not already marked 'is-visible'
        }

        // --- Accessibility: Focus Trapping ---
        function trapFocus(element) {
            if (!element) return;
            const focusableEls = Array.from(element.querySelectorAll(FOCUSABLE_MODAL_ELEMENTS)).filter(el => el.offsetParent !== null);

            if (focusableEls.length === 0) {
                const closeButton = element.querySelector('.icon-close, #modal-close-button');
                if (closeButton) { try { closeButton.focus(); } catch (e) {} }
                else if (element.hasAttribute('tabindex')) { try { element.focus(); } catch (e) {} }
                return;
            }

            const firstFocusableEl = focusableEls[0];
            const lastFocusableEl = focusableEls[focusableEls.length - 1];

            try { firstFocusableEl.focus({ preventScroll: true }); } catch (e) {}

            const handleKeyDown = (e) => {
                if (e.key !== 'Tab') return;
                const currentFocusableEls = Array.from(element.querySelectorAll(FOCUSABLE_MODAL_ELEMENTS)).filter(el => el.offsetParent !== null);
                if (currentFocusableEls.length === 0) { e.preventDefault(); return; }
                const currentFirst = currentFocusableEls[0];
                const currentLast = currentFocusableEls[currentFocusableEls.length - 1];
                const currentlyFocused = document.activeElement;

                if (e.shiftKey) {
                    if (currentlyFocused === currentFirst || !element.contains(currentlyFocused)) {
                        e.preventDefault(); try { currentLast.focus({ preventScroll: true }); } catch (e) {}
                    }
                } else {
                     if (currentlyFocused === currentLast || !element.contains(currentlyFocused)) {
                        e.preventDefault(); try { currentFirst.focus({ preventScroll: true }); } catch (e) {}
                    }
                }
            };
            element.focusTrapHandler = handleKeyDown;
            element.addEventListener('keydown', element.focusTrapHandler);
        }
        function releaseFocus(element = Cache.projectModal) {
            if (!element || typeof element.focusTrapHandler !== 'function') return;
            element.removeEventListener('keydown', element.focusTrapHandler);
            delete element.focusTrapHandler;
            if (focusedElementBeforeModal) {
                try { focusedElementBeforeModal.focus({ preventScroll: true }); } catch (e) {}
                focusedElementBeforeModal = null;
            }
        }

        // --- Project Modal ---
        function openProjectModal(workItemElement) {
            if (!workItemElement || !Cache.modalOverlay || !Cache.modalContent || !Cache.modalTitle || !Cache.modalDesc || !Cache.modalTech || !Cache.modalLinks || !Cache.modalLearningsContainer || !Cache.modalCloseButton) {
                console.error("Modal elements not found or work item invalid.");
                return;
            }

            // Populate Modal Content using dataset
            Cache.modalTitle.textContent = workItemElement.dataset.modalTitle || 'Project Details';
            Cache.modalDesc.textContent = workItemElement.dataset.modalDesc || 'No description available.';
            Cache.modalTech.textContent = workItemElement.dataset.modalTech || 'N/A';

            Cache.modalLearningsContainer.innerHTML = ''; // Clear previous
            const learnings = workItemElement.dataset.modalLearnings;
            if (learnings) {
                Cache.modalLearningsContainer.innerHTML = `<strong class="text-text-main dark:text-dark-text-main font-medium block mb-1">Key Learnings:</strong><p class="text-sm text-text-light dark:text-dark-text-light leading-relaxed">${learnings}</p>`;
            }

            Cache.modalLinks.innerHTML = ''; // Clear previous
            const liveLink = workItemElement.dataset.modalLive;
            const repoLink = workItemElement.dataset.modalRepo;
            if (liveLink) Cache.modalLinks.innerHTML += `<a href="${liveLink}" target="_blank" rel="noopener noreferrer" class="btn btn-primary text-sm px-4 py-2"><i class="fas fa-external-link-alt mr-2"></i> View Live</a>`;
            if (repoLink) Cache.modalLinks.innerHTML += `<a href="${repoLink}" target="_blank" rel="noopener noreferrer" class="btn btn-secondary text-sm px-4 py-2"><i class="fab fa-github mr-2"></i> View Code</a>`;
            if (!liveLink && !repoLink) Cache.modalLinks.innerHTML = '<p class="text-sm text-text-light dark:text-dark-text-light italic">No external links available.</p>';

            focusedElementBeforeModal = document.activeElement;
            Cache.modalOverlay.classList.add('active');
            Cache.modalOverlay.setAttribute('aria-hidden', 'false');
            isModalOpen = true;
            document.body.style.overflow = 'hidden';

            setTimeout(() => {
                trapFocus(Cache.modalContent);
                const firstFocusable = Cache.modalContent.querySelector(FOCUSABLE_MODAL_ELEMENTS);
                 try { (firstFocusable || Cache.modalCloseButton || Cache.modalContent).focus({ preventScroll: true }); } catch (e) {}
            }, 50);
        }
        function closeProjectModal() {
            if (!Cache.modalOverlay || !isModalOpen) return;
            Cache.modalOverlay.classList.remove('active');
            Cache.modalOverlay.setAttribute('aria-hidden', 'true');
            isModalOpen = false;
            document.body.style.overflow = '';
            releaseFocus(Cache.modalContent);
        }

        // --- Footer & Scrolling ---
        function setFooterYear() {
            const currentYearSpan = document.getElementById('current-year');
            if (currentYearSpan) currentYearSpan.textContent = new Date().getFullYear();
        }
        function smoothScrollTo(targetElement) {
            const headerOffset = Cache.siteHeader?.offsetHeight ?? SCROLL_OFFSET;
            const elementPosition = targetElement.getBoundingClientRect().top;
            const offsetPosition = elementPosition + window.pageYOffset - headerOffset - 15; // Extra offset
            window.scrollTo({ top: offsetPosition, behavior: "smooth" });
        }
        function updateActiveNavLink() {
            let currentSectionId = '';
            const sections = document.querySelectorAll('main section[id]');
            const scrollY = window.pageYOffset;
            const viewportHeight = window.innerHeight;
            const docHeight = document.documentElement.scrollHeight;

            sections.forEach(section => {
                const sectionTop = section.offsetTop - SCROLL_OFFSET - 50;
                const sectionHeight = section.offsetHeight;
                if (scrollY >= sectionTop && scrollY < sectionTop + sectionHeight) {
                    currentSectionId = section.id;
                }
            });

            if (scrollY + viewportHeight >= docHeight - 100) {
                const lastSection = sections[sections.length - 1];
                if (lastSection) currentSectionId = lastSection.id;
            } else if (currentSectionId === '' && scrollY < (sections[0]?.offsetTop ?? 0)) {
                 currentSectionId = 'hero';
            } else if (currentSectionId === '' && sections.length > 0) {
                 currentSectionId = 'hero';
            }

            Cache.navLinks.forEach(link => {
                const linkHrefHash = link.getAttribute('href');
                const isActive = linkHrefHash === `#${currentSectionId}`;
                link.classList.toggle('active-nav', isActive);
                link.classList.toggle('text-primary', isActive);
                link.classList.toggle('dark:text-dark-primary', isActive);
                link.classList.toggle('font-semibold', isActive);
                link.classList.toggle('text-text-main', !isActive);
                link.classList.toggle('dark:text-dark-text-light', !isActive);
                link.classList.toggle('font-medium', !isActive);
                link.setAttribute('aria-current', isActive ? 'page' : null);
            });
        }
        const debouncedUpdateActiveNav = debounce(updateActiveNavLink, 100);

        function handleScroll() {
            const scrollPosition = window.scrollY;
            Cache.siteHeader?.classList.toggle('shadow-lg', scrollPosition > 50);
            Cache.siteHeader?.classList.toggle('glass-effect', scrollPosition > 50);
            if (Cache.backToTopButton) {
                const isVisible = scrollPosition > 300;
                Cache.backToTopButton.style.opacity = isVisible ? '1' : '0';
                Cache.backToTopButton.style.transform = isVisible ? 'translateY(0)' : 'translateY(1rem)';
                Cache.backToTopButton.style.pointerEvents = isVisible ? 'auto' : 'none';
                Cache.backToTopButton.setAttribute('aria-hidden', (!isVisible).toString());
            }
            debouncedUpdateActiveNav();
        }
        function scrollToTop() { window.scrollTo({ top: 0, behavior: 'smooth' }); }

        // --- Scroll Animations ---
         let animationObserver; // Store observer globally
         function setupScrollAnimations() {
             const animatedElements = document.querySelectorAll('[data-animate]'); // Target elements marked for animation
             const prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;

             if (!('IntersectionObserver' in window)) {
                 console.warn("IntersectionObserver not supported, scroll animations disabled.");
                 animatedElements.forEach(el => el.classList.add('is-visible', 'opacity-100'));
                 return;
             }

             // Disconnect previous observer if exists to avoid observing removed elements
             if (animationObserver) animationObserver.disconnect();

             if (prefersReducedMotion) {
                  console.log("Reduced motion preferred, simplifying animations.");
                  animatedElements.forEach(el => {
                      el.classList.add('is-visible', 'opacity-100');
                      el.style.transition = 'none';
                      // Ensure transforms are reset if any were applied by classes
                      el.style.transform = 'translate(0, 0)';
                  });
                  return; // Exit if reduced motion
             }

              animationObserver = new IntersectionObserver((entries) => {
                 entries.forEach(entry => {
                     if (entry.isIntersecting) {
                         const delay = parseInt(entry.target.dataset.delay || '0', 10);
                         entry.target.style.transitionDelay = `${delay}ms`;
                         entry.target.classList.add('is-visible'); // Trigger animation
                         animationObserver.unobserve(entry.target); // Observe only once
                     }
                 });
             }, { rootMargin: '0px 0px -50px 0px', threshold: 0.1 });

             animatedElements.forEach(el => {
                // Only observe if not already visible (prevents re-observing on filter changes)
                if (!el.classList.contains('is-visible')) {
                     animationObserver.observe(el);
                }
             });
         }


        // --- Contact Info Helpers ---
        function copyEmailToClipboard() {
            const email = Cache.emailAddressSpan?.textContent;
            if (!email || !navigator.clipboard) {
                alert('Failed to copy email.'); return;
            }
            navigator.clipboard.writeText(email).then(() => {
                if (Cache.copyFeedbackSpan) {
                    Cache.copyFeedbackSpan.style.opacity = '1';
                    Cache.copyFeedbackSpan.setAttribute('aria-hidden', 'false');
                    setTimeout(() => {
                        Cache.copyFeedbackSpan.style.opacity = '0';
                        Cache.copyFeedbackSpan.setAttribute('aria-hidden', 'true');
                    }, 2000);
                }
            }).catch(err => {
                console.error('Could not copy text: ', err); alert('Failed to copy email.');
            });
        }

        // --- Event Listener Setup ---
        function addEventListeners() {
            Cache.mobileMenuButton?.addEventListener('click', openmenu);
            Cache.mobileMenuCloseButton?.addEventListener('click', closemenu);
            Cache.sidemenu?.querySelectorAll('a[href^="#"]').forEach(link => link.addEventListener('click', closemenu));

            Cache.tabLinks.forEach(link => {
                link.addEventListener('click', (e) => opentab(e, link.getAttribute('aria-controls')));
                link.addEventListener('keydown', (e) => { if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); opentab(e, link.getAttribute('aria-controls')); }});
            });

            Cache.contactForm?.addEventListener('submit', handleFormSubmit);

            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    const targetId = this.hash;
                    if (this.classList.contains('skip-link') || !targetId || targetId === '#') return;
                    const targetElement = document.querySelector(targetId);
                    if (targetElement) {
                        e.preventDefault();
                        smoothScrollTo(targetElement);
                        setTimeout(() => {
                            targetElement.setAttribute('tabindex', '-1');
                            try { targetElement.focus({ preventScroll: true }); } catch (e) {}
                        }, 600);
                    }
                });
            });

            Cache.backToTopButton?.addEventListener('click', scrollToTop);

            Cache.modalCloseButton?.addEventListener('click', closeProjectModal);
            Cache.modalOverlay?.addEventListener('click', (e) => { if (e.target === Cache.modalOverlay) closeProjectModal(); });
            document.addEventListener('keydown', (e) => { if (e.key === 'Escape' && isModalOpen) closeProjectModal(); });

            Cache.copyEmailBtn?.addEventListener('click', copyEmailToClipboard);

             // Portfolio Show/Less Buttons Listeners
             Cache.portfolioMoreBtn?.addEventListener('click', () => {
                 portfolioShowAll = true;
                 applyPortfolioShowMoreVisibility();
                 // Focus management: Focus the first newly revealed item
                 const firstNewItem = Cache.portfolioList.querySelector(`.work-item:not(.hidden):not(.show-more-item-hidden):nth-child(${PORTFOLIO_INITIAL_VISIBLE_COUNT + 1})`);
                  try { firstNewItem?.focus({ preventScroll: true }); } catch(e) {}
             });
             Cache.portfolioLessBtn?.addEventListener('click', () => {
                 portfolioShowAll = false;
                 applyPortfolioShowMoreVisibility();
                  // Focus management: Focus the "Show More" button
                  try { Cache.portfolioMoreBtn?.focus({ preventScroll: true }); } catch(e) {}
                 // Scroll slightly up to ensure buttons are visible if they were below fold
                  const controlsTop = Cache.portfolioMoreBtn?.getBoundingClientRect().top + window.pageYOffset - (Cache.siteHeader?.offsetHeight || SCROLL_OFFSET) - 30;
                  // Only scroll if the button is actually below the viewport top
                  if (Cache.portfolioMoreBtn?.getBoundingClientRect().top > (Cache.siteHeader?.offsetHeight || SCROLL_OFFSET)) {
                      window.scrollTo({ top: controlsTop, behavior: 'smooth' });
                  }
             });

            window.addEventListener('scroll', handleScroll, { passive: true });
        }

        // --- Initialization ---
        document.addEventListener('DOMContentLoaded', () => {
            console.log("DOM Loaded - Initializing Portfolio v3.6 (Dynamic)...");
            initializeTheme();
            setFooterYear();

            // Render Portfolio Items Dynamically
            renderPortfolio(portfolioData, Cache.portfolioList);

            // Generate Filter Buttons Dynamically
            generateFilterButtons(portfolioData, Cache.portfolioFilters);

            // Setup Show More/Less for About section tabs
            setupToggle(Cache.skillsHiddenWrapper, "li", Cache.skillsMoreBtn, Cache.skillsLessBtn, 0);
            setupToggle(Cache.educationHiddenWrapper, "li", Cache.educationMoreBtn, Cache.educationLessBtn, 0);

            // Apply initial visibility limits for the portfolio
            applyPortfolioShowMoreVisibility();

            // Initialize Typed.js
            if (typeof Typed !== 'undefined' && document.getElementById('typed-output')) {
                 new Typed('#typed-output', {
                    strings: ['from MIT Muzaffarpur.', 'a MERN Stack Developer.', 'a Problem Solver.', 'Passionate about Code.'],
                    typeSpeed: 50, backSpeed: 30, backDelay: 1500, loop: true, smartBackspace: true, cursorChar: '_',
                 });
            } else {
                console.warn("Typed.js library not found or target element missing.");
                const typedOutput = document.getElementById('typed-output');
                if (typedOutput) typedOutput.textContent = "from MIT Muzaffarpur.";
            }

            // Initialize Vanilla-Tilt.js on the generated items
             const workItemsForTilt = Cache.portfolioList?.querySelectorAll('.work-item');
             if (workItemsForTilt && workItemsForTilt.length > 0 && typeof VanillaTilt !== 'undefined') {
                const prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
                if (!prefersReducedMotion) {
                    VanillaTilt.init(workItemsForTilt, { max: 8, speed: 400, glare: true, "max-glare": 0.2 });
                }
             } else if (typeof VanillaTilt === 'undefined') {
                 console.warn("Vanilla-Tilt.js library not found.");
             }

            // Setup scroll animations (Must run AFTER elements are in the DOM)
            setupScrollAnimations();
            // Add event listeners (Must run AFTER elements are in the DOM)
            addEventListeners();

            // Initial setup calls
            handleScroll();
            updateActiveNavLink();

            // Ensure initial tab content visibility is correct
             const activeTabButton = document.querySelector('.tab-links.active-link');
             if (activeTabButton) {
                 const initialPanelId = activeTabButton.getAttribute('aria-controls');
                 Cache.tabContents.forEach(panel => {
                     const isInitial = panel.id === initialPanelId;
                     panel.classList.toggle('hidden', !isInitial);
                     panel.classList.toggle('active-tab', isInitial);
                     panel.setAttribute('aria-hidden', (!isInitial).toString());
                 });
             }
        });

        // Preloader Hiding
        window.addEventListener('load', () => {
            console.log("Window Loaded - Hiding Preloader.");
            if (Cache.preloader) {
                Cache.preloader.classList.add('loaded');
                Cache.preloader.addEventListener('transitionend', () => Cache.preloader?.remove(), { once: true });
            }
        });

        // --- Global Helper Functions (for inline onclick calls if kept, though listeners preferred) ---
        // Note: openProjectModal, closeProjectModal, openmenu, closemenu, scrollToTop are already defined above.
        // showMorePortfolio/showLessPortfolio are removed as they are handled by listeners now.

    </script>

</body>

</html>
